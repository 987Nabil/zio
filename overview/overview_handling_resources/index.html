<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="ZIO" href="/opensearch.xml">
<link rel="stylesheet" href="/css/prism/prism-material-dark.css"><title data-react-helmet="true">Handling Resources | ZIO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://zio.dev/overview/overview_handling_resources"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Handling Resources | ZIO"><meta data-react-helmet="true" name="description" content="This section looks at some of the common ways to safely handle resources using ZIO."><meta data-react-helmet="true" property="og:description" content="This section looks at some of the common ways to safely handle resources using ZIO."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://zio.dev/overview/overview_handling_resources"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/overview/overview_handling_resources" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/overview/overview_handling_resources" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.015efd66.css">
<link rel="preload" href="/assets/js/runtime~main.6c2618d0.js" as="script">
<link rel="preload" href="/assets/js/main.4f43e840.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/overview/overview_index">Overview</a><a class="navbar__item navbar__link" href="/datatypes/index">Data Types</a><a class="navbar__item navbar__link" href="/services/index">Services</a><a class="navbar__item navbar__link" href="/usecases/usecases_index">Use Cases</a><a class="navbar__item navbar__link" href="/howto/index">How to</a><a class="navbar__item navbar__link" href="/resources/index">Resources</a><a class="navbar__item navbar__link" href="/about/about_index">About</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/overview/overview_index">ZIO 2.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/overview/overview_handling_resources">ZIO 2.x</a></li><li><a class="dropdown__link" href="/1.x/overview/overview_handling_resources">ZIO 1.x</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Overview</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_index">Summary</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_creating_effects">Creating Effects</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_basic_operations">Basic Operations</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_handling_errors">Handling Errors</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/overview/overview_handling_resources">Handling Resources</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_basic_concurrency">Basic Concurrency</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_testing_effects">Testing Effects</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_running_effects">Running Effects</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_background">Background</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_performance">Performance</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/overview/overview_platforms">Platforms</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: ZIO 2.x</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Handling Resources</h1></header><p>This section looks at some of the common ways to safely handle resources using ZIO.</p><p>ZIO&#x27;s resource management features work across synchronous, asynchronous, concurrent, and other effect types, and provide strong guarantees even in the presence of failure, interruption, or defects in the application.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="finalizing"></a>Finalizing<a class="hash-link" href="#finalizing" title="Direct link to heading">#</a></h2><p>ZIO provides similar functionality to <code>try</code> / <code>finally</code> with the <code>ZIO#ensuring</code> method. </p><p>Like <code>try</code> / <code>finally</code>, the <code>ensuring</code> operation guarantees that if an effect begins executing and then terminates (for whatever reason), then the finalizer will begin executing.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val finalizer = </span></span><span class="token-line"><span class="token plain">  UIO.succeed(println(&quot;Finalizing!&quot;))</span></span><span class="token-line"><span class="token plain">// finalizer: UIO[Unit] = zio.ZIO$EffectTotal@278c6e41</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val finalized: IO[String, Unit] = </span></span><span class="token-line"><span class="token plain">  IO.fail(&quot;Failed!&quot;).ensuring(finalizer)</span></span><span class="token-line"><span class="token plain">// finalized: IO[String, Unit] = zio.ZIO$Ensuring@557a26c</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The finalizer is not allowed to fail, which means that it must handle any errors internally.</p><p>Like <code>try</code> / <code>finally</code>, finalizers can be nested, and the failure of any inner finalizer will not affect outer finalizers. Nested finalizers will be executed in reverse order, and linearly (not in parallel).</p><p>Unlike <code>try</code> / <code>finally</code>, <code>ensuring</code> works across all types of effects, including asynchronous and concurrent effects.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="acquire-release"></a>Acquire Release<a class="hash-link" href="#acquire-release" title="Direct link to heading">#</a></h2><p>A common use for <code>try</code> / <code>finally</code> is safely acquiring and releasing resources, such as new socket connections or opened files:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val handle = openFile(name)</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">try {</span></span><span class="token-line"><span class="token plain">  processFile(handle)</span></span><span class="token-line"><span class="token plain">} finally closeFile(handle)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ZIO encapsulates this common pattern with <code>ZIO#acquireRelease</code>, which allows you to specify an <em>acquire</em> effect, which acquires a resource; a <em>release</em> effect, which releases it; and a <em>use</em> effect, which uses the resource.</p><p>The release effect is guaranteed to be executed by the runtime system, even in the presence of errors or interruption.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val groupedFileData: IO[IOException, Unit] = </span></span><span class="token-line"><span class="token plain">  openFile(&quot;data.json&quot;).acquireReleaseWith(closeFile(_)) { file =&gt;</span></span><span class="token-line"><span class="token plain">    for {</span></span><span class="token-line"><span class="token plain">      data    &lt;- decodeData(file)</span></span><span class="token-line"><span class="token plain">      grouped &lt;- groupData(data)</span></span><span class="token-line"><span class="token plain">    } yield grouped</span></span><span class="token-line"><span class="token plain">  }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Like <code>ensuring</code>, acquire releases have compositional semantics, so if one acquire release is nested inside another acquire release, and the outer resource is acquired, then the outer release will always be called, even if, for example, the inner release fails.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="next-steps"></a>Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">#</a></h2><p>If you are comfortable with resource handling, then the next step is to learn about <a href="/overview/overview_basic_concurrency">basic concurrency</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/overview/overview_handling_errors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Handling Errors</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/overview/overview_basic_concurrency"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Basic Concurrency Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#finalizing" class="table-of-contents__link">Finalizing</a></li><li><a href="#acquire-release" class="table-of-contents__link">Acquire Release</a></li><li><a href="#next-steps" class="table-of-contents__link">Next Steps</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item">
                <img src="/img/navbar_brand.png" alt="zio">
            </li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items"><li class="footer__item">
              <a href="https://github.com/zio/zio">
                <img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github">
              </a>
            </li></ul></div><div class="col footer__col"><div class="footer__title">Chat with us on Discord</div><ul class="footer__items"><li class="footer__item">
                <a href="https://discord.gg/2ccFBr4">
                  <img src="https://img.shields.io/discord/629491597070827530?logo=discord&style=social" alt="discord">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Follow us on Twitter</div><ul class="footer__items"><li class="footer__item">
                <a href="https://twitter.com/zioscala">
                  <img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&style=social" alt="twitter">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Additional resources</div><ul class="footer__items"><li class="footer__item"><a href="/api/zio/" target="_blank">Latest Scaladoc of ZIO</a></li><li class="footer__item"><a href="/api-1.x/zio/" target="_blank">Scaladoc of ZIO-1.x</a></li><li class="footer__item"><a href="https://javadoc.io/doc/dev.zio/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Scaladoc on javadoc.io<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 ZIO Maintainers - Built with <a href="https://v2.docusaurus.io/">Docusaurus v2</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.6c2618d0.js"></script>
<script src="/assets/js/main.4f43e840.js"></script>
</body>
</html>