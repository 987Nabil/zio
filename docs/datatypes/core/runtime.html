<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Runtime · ZIO</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="A `Runtime[R]` is capable of executing tasks within an environment `R`."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Runtime · ZIO"/><meta property="og:type" content="website"/><meta property="og:url" content="https://zio.dev/"/><meta property="og:description" content="A `Runtime[R]` is capable of executing tasks within an environment `R`."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100,"cornerOffset":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/navbar_brand.png" alt="ZIO"/><h2 class="headerTitleWithLogo">ZIO</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/overview/overview_index" target="_self">Overview</a></li><li class="siteNavGroupActive"><a href="/docs/datatypes/" target="_self">Data Types</a></li><li class=""><a href="/docs/services/" target="_self">Services</a></li><li class=""><a href="/docs/usecases/usecases_index" target="_self">Use Cases</a></li><li class=""><a href="/docs/howto/" target="_self">How to</a></li><li class=""><a href="/docs/resources/" target="_self">Resources</a></li><li class=""><a href="/docs/about/about_index" target="_self">About</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Core Data Types</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/">Introduction</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Core Data Types<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/">Summary</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/zio">ZIO</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/uio">UIO</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/urio">URIO</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/task">Task</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/rio">RIO</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/io">IO</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/exit">Exit</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/core/cause">Cause</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/datatypes/core/runtime">Runtime</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Contextual Types<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/has">Has</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/zlayer">ZLayer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/rlayer">RLayer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/ulayer">ULayer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/layer">Layer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/urlayer">URLayer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/contextual/tasklayer">TaskLayer</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Fiber Primitives<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/fiber/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/fiber/fiber">Fiber</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/fiber/fiberref">FiberRef</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/fiber/fiberid">Fiber.Id</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/fiber/fiberstatus">Fiber.Status</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Concurrency Primitives<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/zref">ZRef</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/ref">Ref</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/zrefsynchronized">ZRef.Synchronized</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/refsynchronized">Ref.Synchronized</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/promise">Promise</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/queue">Queue</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/hub">Hub</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/concurrency/semaphore">Semaphore</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">STM<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/stm">STM</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tarray">TArray</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tset">TSet</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tmap">TMap</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tref">TRef</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tpriorityqueue">TPriorityQueue</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tpromise">TPromise</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tqueue">TQueue</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/treentrantlock">TReentrantLock</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stm/tsemaphore">TSemaphore</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Resource Safety<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/zmanaged">ZManaged</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/managed">Managed</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/task-managed">TaskManaged</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/rmanaged">RManaged</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/umanaged">UManaged</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/resource/urmanaged">URManaged</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Streaming<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/zstream">ZStream</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/stream">Stream</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/ustream">UStream</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/ztransducer">ZTransducer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/transducer">Transducer</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/zsink">ZSink</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/sink">Sink</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/stream/subscription-ref">SubscriptionRef</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Miscellaneous<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/datatypes/misc/">Summary</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/misc/chunk">Chunk</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/misc/schedule">Schedule</a></li><li class="navListItem"><a class="navItem" href="/docs/datatypes/misc/supervisor">Supervisor</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/zio/zio/edit/master/docs/datatypes/core/runtime.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Runtime</h1></header><article><div><span><p>A <code>Runtime[R]</code> is capable of executing tasks within an environment <code>R</code>.</p>
<p>To run an effect, we need a <code>Runtime</code>, which is capable of executing effects. Runtimes bundle a thread pool together with the environment that effects need.</p>
<h2><a class="anchor" aria-hidden="true" id="what-is-a-runtime-system"></a><a href="#what-is-a-runtime-system" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is a Runtime System?</h2>
<p>Whenever we write a ZIO program, we create a ZIO effect from ZIO constructors plus using its combinators. We are building a blueprint. ZIO effect is just a data structure that describes the execution of a concurrent program. So we end up with a tree data structure that contains lots of different data structures combined together to describe what the ZIO effect should do. This data structure doesn't do anything, it is just a description of a concurrent program.</p>
<p>So the most thing we should keep in mind when we are working with a functional effect system like ZIO is that when we are writing code, printing a string onto the console, reading a file, querying a database, and so forth; We are just writing a workflow or blueprint of an application. We are just building a data structure.</p>
<p>So how ZIO run these workflows? This is where ZIO Runtime System comes into play. Whenever we run an <code>unsaferun</code> function, the Runtime System is responsible to step through all the instructions described by the ZIO effect and execute them.</p>
<p>To simplify everything, we can think of a Runtime System like a black box that takes both the ZIO effect (<code>ZIO[R, E, A]</code>) and its environment (<code>R</code>), it will run this effect and then will return its result as an <code>Either[E, A]</code> value.</p>
<p><img src="/docs/assets/zio-runtime-system.svg" alt="ZIO Runtime System"></p>
<h2><a class="anchor" aria-hidden="true" id="responsibilities-of-the-runtime-system"></a><a href="#responsibilities-of-the-runtime-system" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Responsibilities of the Runtime System</h2>
<p>Runtime Systems have a lot of responsibilities:</p>
<ol>
<li><p><strong>Execute every step of the blueprint</strong> — They have to execute every step of the blueprint in a while loop until it's done.</p></li>
<li><p><strong>Handle unexpected errors</strong> — They have to handle unexpected errors, not just the expected ones but also the unexpected ones.</p></li>
<li><p><strong>Spawn concurrent fiber</strong> — They are actually responsible for the concurrency that effect systems have. They have to spawn a fiber every time we call <code>fork</code> on an effect to spawn off a new fiber.</p></li>
<li><p><strong>Cooperatively yield to other fibers</strong> — They have to cooperatively yield to other fibers so that fibers that are sort of hogging the spotlight, don't get to monopolize all the CPU resources. They have to make sure that the fibers split the CPU cores among all the fibers that are working.</p></li>
<li><p><strong>Capture execution and stack traces</strong> — They have to keep track of where we are in the progress of our own user-land code so the nice detailed execution traces can be captured.</p></li>
<li><p><strong>Ensure finalizers are run appropriately</strong> — They have to ensure finalizers are run appropriately at the right point in all circumstances to make sure that resources are closed that clean-up logic is executed. This is the feature that powers ZManaged and all the other resource-safe constructs in ZIO.</p></li>
<li><p><strong>Handle asynchronous callback</strong> — They have to handle this messy job of dealing with asynchronous callbacks. So we don't have to deal with async code. When we are doing ZIO, everything is just async out of the box.</p></li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="running-a-zio-effect"></a><a href="#running-a-zio-effect" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running a ZIO Effect</h2>
<p>There are two ways to run ZIO effect:</p>
<ol>
<li><strong>Using <code>zio.App</code> entry point</strong></li>
<li><strong>Using <code>unsafeRun</code> method directly</strong></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="using-zioapp"></a><a href="#using-zioapp" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using zio.App</h3>
<p>In most cases we use this method to run our ZIO effect. <code>zio.App</code> has a <code>run</code> function which is the main entry point for running a ZIO application on the JVM:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">package</span> zio
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">App</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>]
}
</code></pre>
<p>Assume we have written an effect using ZIO:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.<span class="hljs-type">Console</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myAppLogic</span> </span>=
  <span class="hljs-keyword">for</span> {
    _ &lt;- <span class="hljs-type">Console</span>.printLine(<span class="hljs-string">"Hello! What is your name?"</span>)
    n &lt;- <span class="hljs-type">Console</span>.readLine
    _ &lt;- <span class="hljs-type">Console</span>.printLine(<span class="hljs-string">"Hello, "</span> + n + <span class="hljs-string">", good to meet you!"</span>)
  } <span class="hljs-keyword">yield</span> ()
</code></pre>
<p>Now we can run that effect using <code>run</code> entry point:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]) =
    myAppLogic.exitCode
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="using-unsaferun"></a><a href="#using-unsaferun" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using unsafeRun</h3>
<p>Another way to execute ZIO effect is to feed the ZIO effect to the <code>unsafeRun</code> method of Runtime system:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">RunZIOEffectUsingUnsafeRun</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">scala</span>.<span class="hljs-title">App</span> </span>{
  zio.<span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.unsafeRun(
    myAppLogic
  )
}
</code></pre>
<p>We don't usually use this method to run our effects. One of the use cases of this method is when we are integrating the legacy (non-effectful code) with the ZIO effect. It also helps us to refactor a large legacy code base into a ZIO effect gradually; Assume we have decided to refactor a component in the middle of a legacy code and rewrite that with ZIO. We can start rewriting that component with the ZIO effect and then integrate that component with the existing code base, using the <code>unsafeRun</code> function.</p>
<h2><a class="anchor" aria-hidden="true" id="default-runtime"></a><a href="#default-runtime" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Default Runtime</h2>
<p>ZIO contains a default runtime called <code>Runtime.default</code>, configured with the <code>ZEnv</code> (the default ZIO environment) and a default <code>Platform</code> designed to work well for mainstream usage. It is already implemented as below:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Runtime</span> </span>{
  <span class="hljs-keyword">lazy</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">default</span>: <span class="hljs-type">Runtime</span>[<span class="hljs-type">ZEnv</span>] = <span class="hljs-type">Runtime</span>(<span class="hljs-type">ZEnv</span>.<span class="hljs-type">Services</span>.live, <span class="hljs-type">Platform</span>.<span class="hljs-keyword">default</span>)
}
</code></pre>
<p>The default runtime includes a default <code>Platform</code> which contains minimum capabilities to bootstrap execution of ZIO tasks and live (production) versions of all ZIO built-in services. The default ZIO environment (<code>ZEnv</code>) for the <code>JS</code> platform includes <code>Clock</code>, <code>Console</code>, <code>System</code>, <code>Random</code>; and the <code>JVM</code> platform also has a <code>Blocking</code> service:</p>
<pre><code class="hljs css language-scala"><span class="hljs-comment">// Default JS environment</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">ZEnv</span> </span>= <span class="hljs-type">Clock</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">System</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Random</span>

<span class="hljs-comment">// Default JVM environment</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">ZEnv</span> </span>= <span class="hljs-type">Clock</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">System</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Random</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Blocking</span>
</code></pre>
<p>We can easily access the default <code>Runtime</code> to run an effect:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">MainApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">scala</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">val</span> runtime = <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>
  runtime.unsafeRun(myAppLogic)
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="custom-runtime"></a><a href="#custom-runtime" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Runtime</h2>
<p>Sometimes we need to create a custom <code>Runtime</code> with a user-defined environment and user-specified <code>Platform</code>. Many real applications should not use <code>Runtime.default</code>. Instead, they should make their own <code>Runtime</code> which configures the <code>Platform</code> and environment accordingly.</p>
<p>Some use-cases of custom Runtimes:</p>
<h3><a class="anchor" aria-hidden="true" id="providing-environment-to-runtime-system"></a><a href="#providing-environment-to-runtime-system" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Providing Environment to Runtime System</h3>
<p>The custom runtime can be used to run many different effects that all require the same environment, so we don't have to call <code>ZIO#provide</code> on all of them before we run them.</p>
<p>For example, assume we want to create a <code>Runtime</code> for services that are for testing purposes, and they don't interact with real external APIs. So we can create a runtime, especially for testing.</p>
<p>Let's say we have defined two <code>Logging</code> and <code>Email</code> services:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Logging</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">log</span></span>(line: <span class="hljs-type">String</span>): <span class="hljs-type">UIO</span>[<span class="hljs-type">Unit</span>]
}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Logging</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">log</span></span>(line: <span class="hljs-type">String</span>): <span class="hljs-type">URIO</span>[<span class="hljs-type">Has</span>[<span class="hljs-type">Logging</span>], <span class="hljs-type">Unit</span>] =
    <span class="hljs-type">ZIO</span>.serviceWith[<span class="hljs-type">Logging</span>](_.log(line))
}

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Email</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send</span></span>(user: <span class="hljs-type">String</span>, content: <span class="hljs-type">String</span>): <span class="hljs-type">Task</span>[<span class="hljs-type">Unit</span>]
}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Email</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send</span></span>(user: <span class="hljs-type">String</span>, content: <span class="hljs-type">String</span>): <span class="hljs-type">ZIO</span>[<span class="hljs-type">Has</span>[<span class="hljs-type">Email</span>], <span class="hljs-type">Throwable</span>, <span class="hljs-type">Unit</span>] =
    <span class="hljs-type">ZIO</span>.serviceWith[<span class="hljs-type">Email</span>](_.send(user, content))
}
</code></pre>
<p>We are going to implement a live version of <code>Logging</code> service and also a mock version of <code>Email</code> service for testing:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoggingLive</span>(<span class="hljs-params"></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">Logging</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">log</span></span>(line: <span class="hljs-type">String</span>): <span class="hljs-type">UIO</span>[<span class="hljs-type">Unit</span>] =
    <span class="hljs-type">ZIO</span>.succeed(print(line))
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailMock</span>(<span class="hljs-params"></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">Email</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send</span></span>(user: <span class="hljs-type">String</span>, content: <span class="hljs-type">String</span>): <span class="hljs-type">Task</span>[<span class="hljs-type">Unit</span>] =
    <span class="hljs-type">ZIO</span>.attempt(println(<span class="hljs-string">s"sending email to <span class="hljs-subst">$user</span>"</span>))
}
</code></pre>
<p>Let's create a custom runtime that contains these two service implementations in its environment:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> testableRuntime = <span class="hljs-type">Runtime</span>(
  <span class="hljs-type">Has</span>.allOf[<span class="hljs-type">Logging</span>, <span class="hljs-type">Email</span>](<span class="hljs-type">LoggingLive</span>(), <span class="hljs-type">EmailMock</span>()),
  <span class="hljs-type">Platform</span>.<span class="hljs-keyword">default</span>
)
</code></pre>
<p>Also, we can map the default runtime to the new runtime, so we can append new services to the default ZIO environment:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> testableRuntime: <span class="hljs-type">Runtime</span>[zio.<span class="hljs-type">ZEnv</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Has</span>[<span class="hljs-type">Logging</span>] <span class="hljs-keyword">with</span> <span class="hljs-type">Has</span>[<span class="hljs-type">Email</span>]] =
  <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>
    .map((zenv: zio.<span class="hljs-type">ZEnv</span>) =&gt;
      zenv ++ <span class="hljs-type">Has</span>.allOf[<span class="hljs-type">Logging</span>, <span class="hljs-type">Email</span>](<span class="hljs-type">LoggingLive</span>(), <span class="hljs-type">EmailMock</span>())
    )
</code></pre>
<p>Now we can run our effects using this custom <code>Runtime</code>:</p>
<pre><code class="hljs css language-scala">testableRuntime.unsafeRun(
  <span class="hljs-keyword">for</span> {
    _ &lt;- <span class="hljs-type">Logging</span>.log(<span class="hljs-string">"sending newsletter"</span>)
    _ &lt;- <span class="hljs-type">Email</span>.send(<span class="hljs-string">"David"</span>, <span class="hljs-string">"Hi! Here is today's newsletter."</span>)
  } <span class="hljs-keyword">yield</span> ()
)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="application-monitoring"></a><a href="#application-monitoring" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Application Monitoring</h3>
<p>Sometimes to diagnose runtime issues and understand what is going on in our application we need to add some sort of monitoring task to the Runtime System. It helps us to track fibers and their status.</p>
<p>By adding a <code>Supervisor</code> to the current platform of the Runtime System, we can track the activity of fibers in a program. So every time a fiber gets started, forked, or every time a fiber ends its life, all these contextual pieces of information get reported to that <code>Supervisor</code>.</p>
<p>For example, the <a href="https://zio.github.io/zio-zmx/">ZIO ZMX</a> enables us to monitor our ZIO application. To include that in our project we must add the following line to our <code>build.sbt</code>:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-zmx"</span> % <span class="hljs-string">"0.0.6"</span>
</code></pre>
<p>ZIO ZMX has a specialized <code>Supervisor</code> called <code>ZMXSupervisor</code> that can be added to our existing <code>Runtime</code>:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio._
<span class="hljs-keyword">import</span> zio.console._
<span class="hljs-keyword">import</span> zio.zmx._
<span class="hljs-keyword">import</span> zio.zmx.diagnostics._

<span class="hljs-keyword">val</span> program: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Console</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Unit</span>] =
  <span class="hljs-keyword">for</span> {
    _ &lt;- putStrLn(<span class="hljs-string">"Waiting for input"</span>)
    a &lt;- getStrLn
    _ &lt;- putStrLn(<span class="hljs-string">"Thank you for "</span> + a)
  } <span class="hljs-keyword">yield</span> ()

<span class="hljs-keyword">val</span> diagnosticsLayer: <span class="hljs-type">ZLayer</span>[<span class="hljs-type">ZEnv</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Has</span>[<span class="hljs-type">Diagnostics</span>]] =
  <span class="hljs-type">Diagnostics</span>.make(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">1111</span>)

<span class="hljs-keyword">val</span> runtime: <span class="hljs-type">Runtime</span>[<span class="hljs-type">ZEnv</span>] =
  <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.mapPlatform(_.withSupervisor(<span class="hljs-type">ZMXSupervisor</span>))

runtime.unsafeRun(program.provideCustomLayer(diagnosticsLayer))
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="application-tracing"></a><a href="#application-tracing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Application Tracing</h3>
<p>We can enable or disable execution tracing or configure its setting. Execution tracing has full of junk. There are lots of allocations that all need to be garbage collected afterward. So it has a tremendous impact on the complexity of the application runtime.</p>
<p>Users often turn off tracing in critical areas of their application. Also, when we are doing benchmark operation, it is better to create a <code>Runtime</code> without tracing capability:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.internal.<span class="hljs-type">Tracing</span>
<span class="hljs-keyword">import</span> zio.internal.tracing.<span class="hljs-type">TracingConfig</span>

<span class="hljs-keyword">val</span> rt1 = <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.mapPlatform(_.withTracing(<span class="hljs-type">Tracing</span>.disabled))
<span class="hljs-keyword">val</span> rt2 = <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.mapPlatform(_.withTracing(<span class="hljs-type">Tracing</span>.enabledWith(<span class="hljs-type">TracingConfig</span>.stackOnly)))

<span class="hljs-keyword">val</span> config = <span class="hljs-type">TracingConfig</span>(
  traceExecution = <span class="hljs-literal">true</span>,
  traceEffectOpsInExecution = <span class="hljs-literal">true</span>,
  traceStack = <span class="hljs-literal">true</span>,
  executionTraceLength = <span class="hljs-number">100</span>,
  stackTraceLength = <span class="hljs-number">100</span>,
  ancestryLength = <span class="hljs-number">10</span>,
  ancestorExecutionTraceLength = <span class="hljs-number">10</span>,
  ancestorStackTraceLength = <span class="hljs-number">10</span>
)
<span class="hljs-keyword">val</span> rt3 = <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.mapPlatform(_.withTracingConfig(config))
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="user-defined-executor"></a><a href="#user-defined-executor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>User-defined Executor</h3>
<p>An executor is responsible for executing effects. The way how each effect will be run including detail of threading, scheduling, and so forth, is separated from the caller. So, if we need to have a specialized executor according to our requirements, we can provide that to the ZIO <code>Runtime</code>:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.internal.<span class="hljs-type">Executor</span>
<span class="hljs-keyword">import</span> java.util.concurrent.{<span class="hljs-type">ThreadPoolExecutor</span>, <span class="hljs-type">TimeUnit</span>, <span class="hljs-type">LinkedBlockingQueue</span>}

<span class="hljs-keyword">val</span> runtime = <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.mapPlatform(
  _.withExecutor(
    <span class="hljs-type">Executor</span>.fromThreadPoolExecutor(_ =&gt; <span class="hljs-number">1024</span>)(
      <span class="hljs-keyword">new</span> <span class="hljs-type">ThreadPoolExecutor</span>(
        <span class="hljs-number">5</span>,
        <span class="hljs-number">10</span>,
        <span class="hljs-number">5000</span>,
        <span class="hljs-type">TimeUnit</span>.<span class="hljs-type">MILLISECONDS</span>,
        <span class="hljs-keyword">new</span> <span class="hljs-type">LinkedBlockingQueue</span>[<span class="hljs-type">Runnable</span>]()
      )
    )
  )
)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="benchmarking"></a><a href="#benchmarking" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Benchmarking</h3>
<p>To do benchmark operation, we need a <code>Runtime</code> with settings suitable for that. It would be better to disable tracing and auto-yielding. ZIO has a built-in <code>Platform</code> proper for benchmark operations, called <code>Platform.benchmark</code> which we can map the default <code>Platform</code> to the benchmark version:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> benchmarkRuntime = <span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.mapPlatform(_ =&gt; <span class="hljs-type">Platform</span>.benchmark)
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/datatypes/core/cause"><span class="arrow-prev">← </span><span>Cause</span></a><a class="docs-next button" href="/docs/datatypes/contextual/index"><span>Introduction</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#what-is-a-runtime-system">What is a Runtime System?</a></li><li><a href="#responsibilities-of-the-runtime-system">Responsibilities of the Runtime System</a></li><li><a href="#running-a-zio-effect">Running a ZIO Effect</a><ul class="toc-headings"><li><a href="#using-zioapp">Using zio.App</a></li><li><a href="#using-unsaferun">Using unsafeRun</a></li></ul></li><li><a href="#default-runtime">Default Runtime</a></li><li><a href="#custom-runtime">Custom Runtime</a><ul class="toc-headings"><li><a href="#providing-environment-to-runtime-system">Providing Environment to Runtime System</a></li><li><a href="#application-monitoring">Application Monitoring</a></li><li><a href="#application-tracing">Application Tracing</a></li><li><a href="#user-defined-executor">User-defined Executor</a></li><li><a href="#benchmarking">Benchmarking</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/navbar_brand.png" alt="ZIO"/></a><div><h5>GitHub</h5><a href="https://github.com/zio/zio"><img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github"/></a></div><div><h5>Chat with us on Discord</h5><a href="https://discord.gg/2ccFBr4"><img src="https://img.shields.io/discord/629491597070827530?logo=discord&amp;style=social" alt="discord"/></a></div><div><h5>Follow us on Twitter</h5><a href="https://twitter.com/zioscala"><img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&amp;style=social" alt="twitter"/></a></div><div><h5>Additional resources</h5><a href="https://javadoc.io/doc/dev.zio/zio_2.12/">Scaladoc of zio</a></div><div><a href="https://www.netlify.com"><img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify"/></a></div></section><section class="copyright">Copyright © 2021 ZIO Maintainers</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '0c94b59071da7001757d08ab43d9e033',
                indexName: 'zio',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>