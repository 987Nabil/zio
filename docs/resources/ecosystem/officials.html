<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Official ZIO Libraries · ZIO</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Official ZIO libraries are hosted in the [ZIO organization](https://github.com/zio/) on Github, and are generally maintained by core contributors to ZIO."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Official ZIO Libraries · ZIO"/><meta property="og:type" content="website"/><meta property="og:url" content="https://zio.dev/"/><meta property="og:description" content="Official ZIO libraries are hosted in the [ZIO organization](https://github.com/zio/) on Github, and are generally maintained by core contributors to ZIO."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100,"cornerOffset":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/navbar_brand.png" alt="ZIO"/><h2 class="headerTitleWithLogo">ZIO</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/overview/overview_index" target="_self">Overview</a></li><li class=""><a href="/docs/datatypes/" target="_self">Data Types</a></li><li class=""><a href="/docs/services/" target="_self">Services</a></li><li class=""><a href="/docs/usecases/usecases_index" target="_self">Use Cases</a></li><li class=""><a href="/docs/howto/" target="_self">How to</a></li><li class="siteNavGroupActive"><a href="/docs/resources/" target="_self">Resources</a></li><li class=""><a href="/docs/about/about_index" target="_self">About</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Ecosystem</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/resources/">Summary</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Learning<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/resources/learning/articles">Articles</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/learning/videos">Videos</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/learning/cookbooks">Cookbooks</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/learning/cheatsheets">Cheat Sheets</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/learning/sampleprojects">Sample Projects</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/learning/poweredbyzio">Projects using ZIO</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Ecosystem<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/docs/resources/ecosystem/officials">Official ZIO Libraries</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/ecosystem/community">Community ZIO Libraries</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/ecosystem/compatible">ZIO Compatible Libraries</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/ecosystem/tools">Tools for ZIO</a></li><li class="navListItem"><a class="navItem" href="/docs/resources/ecosystem/templates">Project Templates</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/zio/zio/edit/master/docs/resources/ecosystem/officials.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Official ZIO Libraries</h1></header><article><div><span><p>Official ZIO libraries are hosted in the <a href="https://github.com/zio/">ZIO organization</a> on Github, and are generally maintained by core contributors to ZIO.</p>
<p>Each project in the ZIO organization namespace has a <em>Stage Badge</em> which indicates the current status of that project:</p>
<ul>
<li><p><strong>Production Ready</strong> — The project is stable and already used in production. We can expect reliability for the implemented use cases.</p></li>
<li><p><strong>Development</strong> — The project already has RC or milestone releases, but is still under active development. We should not expect full stability yet.</p></li>
<li><p><strong>Experimental</strong> — The project is not yet released, but an important part of the work is already done.</p></li>
<li><p><strong>Research</strong> — The project is at the design stage, with some sketches of work but nothing usable yet.</p></li>
<li><p><strong>Concept</strong> — The project is just an idea, development hasn't started yet.</p></li>
<li><p><strong>Deprecated</strong> — The project is not maintained anymore, and we don't recommend its usage.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="zio-actors"></a><a href="#zio-actors" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Actors</h2>
<p><a href="https://github.com/zio/zio-actors">ZIO Actors</a> is a high-performance, purely functional library for building, composing, and supervising typed actors based on ZIO.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction"></a><a href="#introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>ZIO Actors is based on the <em>Actor Model</em> which is a conceptual model of concurrent computation. In the actor model, the <em>actor</em> is the fundamental unit of computation, unlike the ZIO concurrency model, which is the fiber.</p>
<p>Each actor has a mailbox that stores and processes the incoming messages in FIFO order. An actor allowed to:</p>
<ul>
<li>create another actor.</li>
<li>send a message to itself or other actors.</li>
<li>handle the incoming message, and:
<ul>
<li>decide <strong>what to do</strong> based on the current state and the received message.</li>
<li>decide <strong>what is the next state</strong> based on the current state and the received message.</li>
</ul></li>
</ul>
<p>Some characteristics of an <em>Actor Model</em>:</p>
<ul>
<li><p><strong>Isolated State</strong> — Each actor holds its private state. They only have access to their internal state. They are isolated from each other, and they do not share the memory. The only way to change the state of an actor is to send a message to that actor.</p></li>
<li><p><strong>Process of One Message at a Time</strong> — Each actor handles and processes one message at a time. They read messages from their inboxes and process them sequentially.</p></li>
<li><p><strong>Actor Persistence</strong> — A persistent actor records its state as events. The actor can recover its state from persisted events after a crash or restart.</p></li>
<li><p><strong>Remote Messaging</strong> — Actors can communicate with each other only through messages. They can run locally or remotely on another machine. Remote actors can communicate with each other transparently as if there are located locally.</p></li>
<li><p><strong>Actor Supervision</strong> — Parent actors can supervise their child actors. For example, if a child actor fails, the supervisor actor can restart that actor.</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>To use this library, we need to add the following line to our library dependencies in <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-actors"</span> % <span class="hljs-string">"0.0.9"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's try to implement a simple Counter Actor which receives two <code>Increase</code> and <code>Get</code> commands:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.actors.<span class="hljs-type">Actor</span>.<span class="hljs-type">Stateful</span>
<span class="hljs-keyword">import</span> zio.actors._
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">UIO</span>, <span class="hljs-type">URIO</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-keyword">sealed</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Message</span>[+_]</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Increase</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Message</span>[<span class="hljs-type">Unit</span>]</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Get</span>      <span class="hljs-keyword">extends</span> <span class="hljs-title">Message</span>[<span class="hljs-type">Int</span>]</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CounterActorExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-comment">// Definition of stateful actor</span>
  <span class="hljs-keyword">val</span> counterActor: <span class="hljs-type">Stateful</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Int</span>, <span class="hljs-type">Message</span>] =
    <span class="hljs-keyword">new</span> <span class="hljs-type">Stateful</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Int</span>, <span class="hljs-type">Message</span>] {
      <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span></span>[<span class="hljs-type">A</span>](
          state: <span class="hljs-type">Int</span>,
          msg: <span class="hljs-type">Message</span>[<span class="hljs-type">A</span>],
          context: <span class="hljs-type">Context</span>
      ): <span class="hljs-type">UIO</span>[(<span class="hljs-type">Int</span>, <span class="hljs-type">A</span>)] =
        msg <span class="hljs-keyword">match</span> {
          <span class="hljs-keyword">case</span> <span class="hljs-type">Increase</span> =&gt; <span class="hljs-type">UIO</span>((state + <span class="hljs-number">1</span>, ()))
          <span class="hljs-keyword">case</span> <span class="hljs-type">Get</span>      =&gt; <span class="hljs-type">UIO</span>((state, state))
        }
    }

  <span class="hljs-keyword">val</span> myApp: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Clock</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Int</span>] =
    <span class="hljs-keyword">for</span> {
      system &lt;- <span class="hljs-type">ActorSystem</span>(<span class="hljs-string">"MyActorSystem"</span>)
      actor  &lt;- system.make(<span class="hljs-string">"counter"</span>, <span class="hljs-type">Supervisor</span>.none, <span class="hljs-number">0</span>, counterActor)
      _      &lt;- actor ! <span class="hljs-type">Increase</span>
      _      &lt;- actor ! <span class="hljs-type">Increase</span>
      s      &lt;- actor ? <span class="hljs-type">Get</span>
    } <span class="hljs-keyword">yield</span> s

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    myApp
      .flatMap(state =&gt; putStrLn(<span class="hljs-string">s"The final state of counter: <span class="hljs-subst">$state</span>"</span>))
      .exitCode
}
</code></pre>
<p>Akka actors also has some other optional modules for persistence (which is useful for event sourcing) and integration with Akka toolkit:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-actors-persistence"</span> % zioActorsVersion
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-actors-persistence-jdbc"</span> % zioActorVersion
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-actors-akka-interop"</span> % zioActorVersion
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-akka-cluster"></a><a href="#zio-akka-cluster" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Akka Cluster</h2>
<p>The <a href="https://github.com/zio/zio-akka-cluster">ZIO Akka Cluster</a> library is a ZIO wrapper on <a href="https://doc.akka.io/docs/akka/current/index-cluster.html">Akka Cluster</a>. We can use clustering features of the Akka toolkit without the need to use the actor model.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-1"></a><a href="#introduction-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>This library provides us following features:</p>
<ul>
<li><p><strong>Akka Cluster</strong> — This feature contains two Akka Cluster Membership operations called <code>join</code> and <code>leave</code> and also it has some methods to retrieve <em>Cluster State</em> and <em>Cluster Events</em>.</p></li>
<li><p><strong>Akka Distributed PubSub</strong> — Akka has a <em>Distributed Publish Subscribe</em> facility in the cluster. It helps us to send a message to all actors in the cluster that have registered and subscribed for a specific topic name without knowing their physical address or without knowing which node they are running on.</p></li>
<li><p><strong>Akka Cluster Sharding</strong> — Cluster sharding is useful when we need to <em>distribute actors across several nodes in the cluster</em> and want to be able to interact with them using their logical identifier without having to care about their physical location in the cluster, which might also change over time. When we have many stateful entities in our application that together they consume more resources (e.g. memory) than fit on one machine, it is useful to use <em>Akka Cluster Sharding</em> to distribute our entities to multiple nodes.</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-1"></a><a href="#installation-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-akka-cluster"</span> % <span class="hljs-string">"0.2.0"</span> <span class="hljs-comment">// Check the repo for the latest version</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-1"></a><a href="#example-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In the following example, we are using all these three features. We have a distributed counter application that lives in the Akka Cluster using <em>Akka Cluster Sharding</em> feature. So the location of <code>LiveUsers</code> and <code>TotalRequests</code> entities in the cluster is transparent for us. We send the result of each entity to the <em>Distributed PubSub</em>. So every node in the cluster can subscribe and listen to those results. Also, we have created a fiber that is subscribed to the cluster events. All the new events will be logged to the console:</p>
<pre><code class="hljs css language-scala">import akka.actor.ActorSystem
import com.typesafe.config.{Config, ConfigFactory}
import zio.akka.cluster.Cluster
import zio.akka.cluster.sharding.{Entity, Sharding}
import zio.console.putStrLn
import zio.{ExitCode, Has, Managed, Task, URIO, ZIO, ZLayer}

sealed trait Counter extends Product with Serializable
case object Inc extends Counter
case object Dec extends Counter

case class CounterApp(port: String) {
  val config: Config =
    ConfigFactory.parseString(
      s"""
         |akka {
         |  actor {
         |    provider = "cluster"
         |  }
         |  remote {
         |    netty.tcp {
         |      hostname = "127.0.0.1"
         |      port = $port
         |    }
         |  }
         |  cluster {
         |    seed-nodes = ["akka.tcp://CounterApp@127.0.0.1:2551"]
         |  }
         |}
         |""".stripMargin)

  val actorSystem: ZLayer[Any, Throwable, Has[ActorSystem]] =
    ZLayer.fromManaged(
      Managed.make(Task(ActorSystem("CounterApp", config)))(sys =&gt;
        Task.fromFuture(_ =&gt; sys.terminate()).either
      )
    )

  val counterApp: ZIO[zio.ZEnv, Throwable, Unit] =
    actorSystem.build.use(sys =&gt;
      for {
        queue &lt;- Cluster
          .clusterEvents(true)
          .provideCustomLayer(ZLayer.succeedMany(sys))

        pubsub &lt;- zio.akka.cluster.pubsub.PubSub
          .createPubSub[Int]
          .provideCustomLayer(ZLayer.succeedMany(sys))

        liveUsersLogger &lt;- pubsub
          .listen("LiveUsers")
          .flatMap(
            _.take.tap(u =&gt; putStrLn(s"Number of live users: $u")).forever
          )
          .fork
        totalRequestLogger &lt;- pubsub
          .listen("TotalRequests")
          .flatMap(
            _.take.tap(r =&gt; putStrLn(s"Total request until now: $r")).forever
          )
          .fork

        clusterEvents &lt;- queue.take
          .tap(x =&gt; putStrLn("New event in cluster: " + x.toString))
          .forever
          .fork

        counterEntityLogic = (c: Counter) =&gt;
          for {
            entity &lt;- ZIO.environment[Entity[Int]]
            newState &lt;- c match {
              case Inc =&gt;
                entity.get.state.updateAndGet(s =&gt; Some(s.getOrElse(0) + 1))
              case Dec =&gt;
                entity.get.state.updateAndGet(s =&gt; Some(s.getOrElse(0) - 1))
            }
            _ &lt;- pubsub.publish(entity.get.id, newState.getOrElse(0)).orDie
          } yield ()
        cluster &lt;- Sharding
          .start("CounterEntity", counterEntityLogic)
          .provideCustomLayer(ZLayer.succeedMany(sys))

        _ &lt;- cluster.send("LiveUsers", Inc)
        _ &lt;- cluster.send("TotalRequests", Inc)
        _ &lt;- cluster.send("LiveUsers", Dec)
        _ &lt;- cluster.send("LiveUsers", Inc)
        _ &lt;- cluster.send("LiveUsers", Inc)
        _ &lt;- cluster.send("TotalRequests", Inc)
        _ &lt;- cluster.send("TotalRequests", Inc)

        _ &lt;-
          clusterEvents.join zipPar liveUsersLogger.join zipPar totalRequestLogger.join
      } yield ()
    )
}
</code></pre>
<p>Now, let's create a cluster comprising two nodes:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CounterApp1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] = 
    <span class="hljs-type">CounterApp</span>(<span class="hljs-string">"2551"</span>).counterApp.exitCode
}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CounterApp2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] = 
    <span class="hljs-type">CounterApp</span>(<span class="hljs-string">"2552"</span>).counterApp.exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-cache"></a><a href="#zio-cache" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Cache</h2>
<p>ZIO Cache is a library that makes it easy to optimize the performance of our application by caching values.</p>
<p>Sometimes we may call or receive requests to do overlapping work. Assume we are writing a service that is going to handle all incoming requests. We don't want to handle duplicate requests. Using ZIO Cache we can make our application to be more <strong>performant</strong> by preventing duplicated works.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-2"></a><a href="#introduction-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>Some key features of ZIO Cache:</p>
<ul>
<li><p><strong>Compositionality</strong> — If we want our applications to be <strong>compositional</strong>, different parts of our application may do overlapping work. ZIO Cache helps us to stay benefit from compositionality while using caching.</p></li>
<li><p><strong>Unification of Synchronous and Asynchronous Caches</strong> — Compositional definition of cache in terms of <em>lookup function</em> unifies synchronous and asynchronous caches. So the lookup function can compute value either synchronously or asynchronously.</p></li>
<li><p><strong>Deep ZIO Integration</strong> — ZIO Cache is a ZIO native solution. So without losing the power of ZIO it includes support for <em>concurrent lookups</em>, <em>failure</em>, and <em>interruption</em>.</p></li>
<li><p><strong>Caching Policy</strong> — Using caching policy, the ZIO Cache can determine when values should/may be removed from the cache. So, if we want to build something more complex and custom we have a lot of flexibility. The caching policy has two parts and together they define a whole caching policy:</p>
<ul>
<li><p><strong>Priority (Optional Removal)</strong> — When we are running out of space, it defines the order that the existing values <strong>might</strong> be removed from the cache to make more space.</p></li>
<li><p><strong>Evict (Mandatory Removal)</strong> — Regardless of space when we <strong>must</strong> remove existing values because they are no longer valid anymore. They might be invalid because they do not satisfy business requirements (e.g., maybe it's too old). This is a function that determines whether an entry is valid based on the entry and the current time.</p></li>
</ul></li>
<li><p><strong>Composition Caching Policy</strong> — We can define much more complicated caching policies out of much simpler ones.</p></li>
<li><p><strong>Cache/Entry Statistics</strong> — ZIO Cache maintains some good statistic metrics, such as entries, memory size, hits, misses, loads, evictions, and total load time. So we can look at how our cache is doing and decide where we should change our caching policy to improve caching metrics.</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-2"></a><a href="#installation-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-cache"</span> % <span class="hljs-string">"0.1.0"</span> <span class="hljs-comment">// Check the repo for the latest version</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-2"></a><a href="#example-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this example, we are calling <code>timeConsumingEffect</code> three times in parallel with the same key. The ZIO Cache runs this effect only once. So the concurrent lookups will suspend until the value being computed is available:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.cache.{<span class="hljs-type">Cache</span>, <span class="hljs-type">Lookup</span>}
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.console.{<span class="hljs-type">Console</span>, putStrLn}
<span class="hljs-keyword">import</span> zio.duration.{<span class="hljs-type">Duration</span>, durationInt}
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">URIO</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-keyword">import</span> java.io.<span class="hljs-type">IOException</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">timeConsumingEffect</span></span>(key: <span class="hljs-type">String</span>): <span class="hljs-type">ZIO</span>[<span class="hljs-type">Clock</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">Int</span>] =
  <span class="hljs-type">ZIO</span>.sleep(<span class="hljs-number">5.</span>seconds) *&gt; <span class="hljs-type">ZIO</span>.succeed(key.hashCode)

<span class="hljs-keyword">val</span> myApp: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Clock</span>, <span class="hljs-type">IOException</span>, <span class="hljs-type">Unit</span>] =
  <span class="hljs-keyword">for</span> {
    cache &lt;- <span class="hljs-type">Cache</span>.make(
      capacity = <span class="hljs-number">100</span>,
      timeToLive = <span class="hljs-type">Duration</span>.<span class="hljs-type">Infinity</span>,
      lookup = <span class="hljs-type">Lookup</span>(timeConsumingEffect)
    )
    result &lt;- cache.get(<span class="hljs-string">"key1"</span>)
                .zipPar(cache.get(<span class="hljs-string">"key1"</span>))
                .zipPar(cache.get(<span class="hljs-string">"key1"</span>))
    _ &lt;- putStrLn(<span class="hljs-string">s"Result of parallel execution three effects with the same key: <span class="hljs-subst">$result</span>"</span>)

    hits &lt;- cache.cacheStats.map(_.hits)
    misses &lt;- cache.cacheStats.map(_.misses)
    _ &lt;- putStrLn(<span class="hljs-string">s"Number of cache hits: <span class="hljs-subst">$hits</span>"</span>)
    _ &lt;- putStrLn(<span class="hljs-string">s"Number of cache misses: <span class="hljs-subst">$misses</span>"</span>)
  } <span class="hljs-keyword">yield</span> ()
</code></pre>
<p>The output of this program should be as follows:</p>
<pre><code class="hljs">Result of parallel execution three effects <span class="hljs-keyword">with</span> the same <span class="hljs-keyword">key</span>: ((<span class="hljs-number">3288498</span>,<span class="hljs-number">3288498</span>),<span class="hljs-number">3288498</span>)
<span class="hljs-built_in">Number</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">cache</span> hits: <span class="hljs-number">2</span>
<span class="hljs-built_in">Number</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">cache</span> misses: <span class="hljs-number">1</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-config"></a><a href="#zio-config" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Config</h2>
<p><a href="https://zio.github.io/zio-config/">ZIO Config</a> is a ZIO-based library for loading and parsing configuration sources.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-3"></a><a href="#introduction-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>In the real world, config retrieval is the first to develop applications. We mostly have some application config that should be loaded and parsed through our application. Doing such things manually is always boring and error-prone and also has lots of boilerplates.</p>
<p>The ZIO Config has a lot of features, and it is more than just a config parsing library. Let's enumerate some key features of this library:</p>
<ul>
<li><p><strong>Support for Various Sources</strong> — It can read/write flat or nested configurations from/to various formats and sources.</p></li>
<li><p><strong>Composable sources</strong> — ZIO Config can compose sources of configuration, so we can have, e.g. environmental or command-line overrides.</p></li>
<li><p><strong>Automatic Document Generation</strong> — It can auto-generate documentation of configurations. So developers or DevOps engineers know how to configure the application.</p></li>
<li><p><strong>Report generation</strong> — It has a report generation that shows where each piece of configuration data came from.</p></li>
<li><p><strong>Automatic Derivation</strong> — It has built-in support for automatic derivation of readers and writers for case classes and sealed traits.</p></li>
<li><p><strong>Type-level Constraints and Automatic Validation</strong> — because it supports <em>Refined</em> types, we can write type-level predicates which constrain the set of values described for data types.</p></li>
<li><p><strong>Descriptive Errors</strong> — It accumulates all errors and reports all of them to the user rather than failing fast.</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-3"></a><a href="#installation-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-config"</span> % &lt;version&gt;
</code></pre>
<p>There are also some optional dependencies:</p>
<ul>
<li><strong>zio-config-mangolia</strong> — Auto Derivation</li>
<li><strong>zio-config-refined</strong> — Integration with Refined Library</li>
<li><strong>zio-config-typesafe</strong> — HOCON/Json Support</li>
<li><strong>zio-config-yaml</strong> — Yaml Support</li>
<li><strong>zio-config-gen</strong> — Random Config Generation</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="example-3"></a><a href="#example-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's add these four lines to our <code>build.sbt</code> file as we are using these modules in our example:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-config"</span>          % <span class="hljs-string">"1.0.6"</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-config-magnolia"</span> % <span class="hljs-string">"1.0.6"</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-config-typesafe"</span> % <span class="hljs-string">"1.0.6"</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-config-refined"</span>  % <span class="hljs-string">"1.0.6"</span>
</code></pre>
<p>In this example we are reading from HOCON config format using type derivation:</p>
<pre><code class="hljs css language-scala">import eu.timepit.refined.W
import eu.timepit.refined.api.Refined
import eu.timepit.refined.collection.NonEmpty
import eu.timepit.refined.numeric.GreaterEqual
import zio.config.magnolia.{describe, descriptor}
import zio.config.typesafe.TypesafeConfigSource
import zio.console.putStrLn
import zio.{ExitCode, URIO, ZIO}

sealed trait DataSource

final case class Database(
    @describe("Database Host Name")
    host: Refined[String, NonEmpty],
    @describe("Database Port")
    port: Refined[Int, GreaterEqual[W.`1024`.T]]
) extends DataSource

final case class Kafka(
    @describe("Kafka Topics")
    topicName: String,
    @describe("Kafka Brokers")
    brokers: List[String]
) extends DataSource

object ZIOConfigExample extends zio.App {
  import zio.config._
  import zio.config.refined._

  val json =
    s"""
       |"Database" : {
       |  "port" : "1024",
       |  "host" : "localhost"
       |}
       |""".stripMargin

  val myApp =
    for {
      source &lt;- ZIO.fromEither(TypesafeConfigSource.fromHoconString(json))
      desc = descriptor[DataSource] from source
      dataSource &lt;- ZIO.fromEither(read(desc))
      // Printing Auto Generated Documentation of Application Config
      _ &lt;- putStrLn(generateDocs(desc).toTable.toGithubFlavouredMarkdown)
      _ &lt;- dataSource match {
        case Database(host, port) =&gt;
          putStrLn(s"Start connecting to the database: $host:$port")
        case Kafka(_, brokers) =&gt;
          putStrLn(s"Start connecting to the kafka brokers: $brokers")
      }
    } yield ()

  override def run(args: List[String]): URIO[zio.ZEnv, ExitCode] =
    myApp.exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-ftp"></a><a href="#zio-ftp" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO FTP</h2>
<p><a href="https://github.com/zio/zio-ftp">ZIO FTP</a> is a simple, idiomatic (S)FTP client for ZIO.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-4"></a><a href="#installation-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-ftp"</span> % <span class="hljs-string">"0.3.0"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-4"></a><a href="#example-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>First we need an FTP server if we don't have:</p>
<pre><code class="hljs css language-bash">docker run -d \
    -p 21:21 \
    -p 21000-21010:21000-21010 \
    -e USERS=<span class="hljs-string">"one|1234"</span> \
    -e ADDRESS=localhost \
    delfer/alpine-ftp-server
</code></pre>
<p>Now we can run the example:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.blocking.<span class="hljs-type">Blocking</span>
<span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.ftp.<span class="hljs-type">Ftp</span>._
<span class="hljs-keyword">import</span> zio.ftp._
<span class="hljs-keyword">import</span> zio.stream.{<span class="hljs-type">Transducer</span>, <span class="hljs-type">ZStream</span>}
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">Chunk</span>, <span class="hljs-type">ExitCode</span>, <span class="hljs-type">URIO</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIOFTPExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> settings =
    <span class="hljs-type">UnsecureFtpSettings</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">21</span>, <span class="hljs-type">FtpCredentials</span>(<span class="hljs-string">"one"</span>, <span class="hljs-string">"1234"</span>))

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> myApp = <span class="hljs-keyword">for</span> {
    _        &lt;- putStrLn(<span class="hljs-string">"List of files at root directory:"</span>)
    resource &lt;- ls(<span class="hljs-string">"/"</span>).runCollect
    _        &lt;- <span class="hljs-type">ZIO</span>.foreach(resource)(e =&gt; putStrLn(e.path))
    path = <span class="hljs-string">"~/file.txt"</span>
    _ &lt;- upload(
      path,
      <span class="hljs-type">ZStream</span>.fromChunk(
        <span class="hljs-type">Chunk</span>.fromArray(<span class="hljs-string">"Hello, ZIO FTP!\nHello, World!"</span>.getBytes)
      )
    )
    file &lt;- readFile(path)
      .transduce(<span class="hljs-type">Transducer</span>.utf8Decode)
      .runCollect
    _ &lt;- putStrLn(<span class="hljs-string">s"Content of <span class="hljs-subst">$path</span> file:"</span>)
    _ &lt;- putStrLn(file.fold(<span class="hljs-string">""</span>)(_ + _))
  } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] = myApp
    .provideCustomLayer(
      unsecure(settings) ++ <span class="hljs-type">Blocking</span>.live
    )
    .exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-json"></a><a href="#zio-json" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO JSON</h2>
<p><a href="https://github.com/zio/zio-json">ZIO Json</a> is a fast and secure JSON library with tight ZIO integration.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-4"></a><a href="#introduction-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>The goal of this project is to create the best all-round JSON library for Scala:</p>
<ul>
<li><strong>Performance</strong> to handle more requests per second than the incumbents, i.e. reduced operational costs.</li>
<li><strong>Security</strong> to mitigate against adversarial JSON payloads that threaten the capacity of the server.</li>
<li><strong>Fast Compilation</strong> no shapeless, no type astronautics.</li>
<li><strong>Future-Proof</strong>, prepared for Scala 3 and next-generation Java.</li>
<li><strong>Simple</strong> small codebase, concise documentation that covers everything.</li>
<li><strong>Helpful errors</strong> are readable by humans and machines.</li>
<li><strong>ZIO Integration</strong> so nothing more is required.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-5"></a><a href="#installation-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-json"</span> % <span class="hljs-string">"0.1.5"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-5"></a><a href="#example-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's try a simple example of encoding and decoding JSON using ZIO JSON:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.json._

<span class="hljs-keyword">sealed</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Fruit</span>                   <span class="hljs-keyword">extends</span> <span class="hljs-title">Product</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Serializable</span></span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Banana</span>(<span class="hljs-params">curvature: <span class="hljs-type">Double</span></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">Fruit</span></span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Apple</span>(<span class="hljs-params">poison: <span class="hljs-type">Boolean</span></span>)    <span class="hljs-keyword">extends</span> <span class="hljs-title">Fruit</span></span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Fruit</span> </span>{
  <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">val</span> decoder: <span class="hljs-type">JsonDecoder</span>[<span class="hljs-type">Fruit</span>] =
    <span class="hljs-type">DeriveJsonDecoder</span>.gen[<span class="hljs-type">Fruit</span>]

  <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">val</span> encoder: <span class="hljs-type">JsonEncoder</span>[<span class="hljs-type">Fruit</span>] =
    <span class="hljs-type">DeriveJsonEncoder</span>.gen[<span class="hljs-type">Fruit</span>]
}

<span class="hljs-keyword">val</span> json1         = <span class="hljs-string">""</span><span class="hljs-string">"{ "</span><span class="hljs-type">Banana</span><span class="hljs-string">":{ "</span><span class="hljs-string">curvature":0.5 }}"</span><span class="hljs-string">""</span>
<span class="hljs-comment">// json1: String = "{ \"Banana\":{ \"curvature\":0.5 }}"</span>
<span class="hljs-keyword">val</span> json2         = <span class="hljs-string">""</span><span class="hljs-string">"{ "</span><span class="hljs-type">Apple</span><span class="hljs-string">": { "</span><span class="hljs-string">poison": false }}"</span><span class="hljs-string">""</span>
<span class="hljs-comment">// json2: String = "{ \"Apple\": { \"poison\": false }}"</span>
<span class="hljs-keyword">val</span> malformedJson = <span class="hljs-string">""</span><span class="hljs-string">"{ "</span><span class="hljs-type">Banana</span><span class="hljs-string">":{ "</span><span class="hljs-string">curvature": true }}"</span><span class="hljs-string">""</span>
<span class="hljs-comment">// malformedJson: String = "{ \"Banana\":{ \"curvature\": true }}"</span>

json1.fromJson[<span class="hljs-type">Fruit</span>]
<span class="hljs-comment">// res0: Either[String, Fruit] = Right(value = Banana(curvature = 0.5))</span>
json2.fromJson[<span class="hljs-type">Fruit</span>]
<span class="hljs-comment">// res1: Either[String, Fruit] = Right(value = Apple(poison = false))</span>
malformedJson.fromJson[<span class="hljs-type">Fruit</span>]
<span class="hljs-comment">// res2: Either[String, Fruit] = Left(</span>
<span class="hljs-comment">//   value = ".Banana.curvature(expected a number, got t)"</span>
<span class="hljs-comment">// )</span>

<span class="hljs-type">List</span>(<span class="hljs-type">Apple</span>(<span class="hljs-literal">false</span>), <span class="hljs-type">Banana</span>(<span class="hljs-number">0.4</span>)).toJsonPretty
<span class="hljs-comment">// res3: String = """[{</span>
<span class="hljs-comment">//   "Apple" : {</span>
<span class="hljs-comment">//     "poison" : false</span>
<span class="hljs-comment">//   }</span>
<span class="hljs-comment">// }, {</span>
<span class="hljs-comment">//   "Banana" : {</span>
<span class="hljs-comment">//     "curvature" : 0.4</span>
<span class="hljs-comment">//   }</span>
<span class="hljs-comment">// }]"""</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-kafka"></a><a href="#zio-kafka" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Kafka</h2>
<p><a href="https://github.com/zio/zio-kafka">ZIO Kafka</a> is a Kafka client for ZIO. It provides a purely functional, streams-based interface to the Kafka client and integrates effortlessly with ZIO and ZIO Streams.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-5"></a><a href="#introduction-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>Apache Kafka is a distributed event streaming platform that acts as a distributed publish-subscribe messaging system. It enables us to build distributed streaming data pipelines and event-driven applications.</p>
<p>Kafka has a mature Java client for producing and consuming events, but it has a low-level API. ZIO Kafka is a ZIO native client for Apache Kafka. It has a high-level streaming API on top of the Java client. So we can produce and consume events using the declarative concurrency model of ZIO Streams.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-6"></a><a href="#installation-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-kafka"</span> % <span class="hljs-string">"0.15.0"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-6"></a><a href="#example-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's write a simple Kafka producer and consumer using ZIO Kafka with ZIO Streams. Before everything, we need a running instance of Kafka. We can do that by saving the following docker-compose script in the <code>docker-compose.yml</code> file and run <code>docker-compose up</code>:</p>
<pre><code class="hljs css language-docker">version: <span class="hljs-string">'2'</span>
services:
  zookeeper:
    image: confluentinc/cp-zookeeper:latest
    environment:
      ZOOKEEPER_CLIENT_PORT: <span class="hljs-number">2181</span>
      ZOOKEEPER_TICK_TIME: <span class="hljs-number">2000</span>
    ports:
      - <span class="hljs-number">22181</span>:<span class="hljs-number">2181</span>
  
  kafka:
    image: confluentinc/cp-kafka:latest
    depends_on:
      - zookeeper
    ports:
      - <span class="hljs-number">29092</span>:<span class="hljs-number">29092</span>
    environment:
      KAFKA_BROKER_ID: <span class="hljs-number">1</span>
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:<span class="hljs-number">2181</span>
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:<span class="hljs-number">9092</span>,PLAINTEXT_HOST://localhost:<span class="hljs-number">29092</span>
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: <span class="hljs-number">1</span>
</code></pre>
<p>Now, we can run our ZIO Kafka Streaming application:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio._
<span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.duration.durationInt
<span class="hljs-keyword">import</span> zio.kafka.consumer.{<span class="hljs-type">Consumer</span>, <span class="hljs-type">ConsumerSettings</span>, _}
<span class="hljs-keyword">import</span> zio.kafka.producer.{<span class="hljs-type">Producer</span>, <span class="hljs-type">ProducerSettings</span>}
<span class="hljs-keyword">import</span> zio.kafka.serde._
<span class="hljs-keyword">import</span> zio.stream.<span class="hljs-type">ZStream</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIOKafkaProducerConsumerExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">val</span> producer =
    <span class="hljs-type">ZStream</span>
      .repeatEffect(zio.random.nextIntBetween(<span class="hljs-number">0</span>, <span class="hljs-type">Int</span>.<span class="hljs-type">MaxValue</span>))
      .schedule(<span class="hljs-type">Schedule</span>.fixed(<span class="hljs-number">2.</span>seconds))
      .mapM { random =&gt;
        <span class="hljs-type">Producer</span>.produce[<span class="hljs-type">Any</span>, <span class="hljs-type">Long</span>, <span class="hljs-type">String</span>](
          topic = <span class="hljs-string">"random"</span>,
          key = random % <span class="hljs-number">4</span>,
          value = random.toString,
          keySerializer = <span class="hljs-type">Serde</span>.long,
          valueSerializer = <span class="hljs-type">Serde</span>.string
        )
      }
      .drain

  <span class="hljs-keyword">val</span> consumer =
    <span class="hljs-type">Consumer</span>
      .subscribeAnd(<span class="hljs-type">Subscription</span>.topics(<span class="hljs-string">"random"</span>))
      .plainStream(<span class="hljs-type">Serde</span>.long, <span class="hljs-type">Serde</span>.string)
      .tap(r =&gt; putStrLn(r.value))
      .map(_.offset)
      .aggregateAsync(<span class="hljs-type">Consumer</span>.offsetBatches)
      .mapM(_.commit)
      .drain

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    producer
      .merge(consumer)
      .runDrain
      .provideCustomLayer(appLayer)
      .exitCode

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">producerLayer</span> </span>= <span class="hljs-type">ZLayer</span>.fromManaged(
    <span class="hljs-type">Producer</span>.make(
      settings = <span class="hljs-type">ProducerSettings</span>(<span class="hljs-type">List</span>(<span class="hljs-string">"localhost:29092"</span>))
    )
  )

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">consumerLayer</span> </span>= <span class="hljs-type">ZLayer</span>.fromManaged(
    <span class="hljs-type">Consumer</span>.make(
      <span class="hljs-type">ConsumerSettings</span>(<span class="hljs-type">List</span>(<span class="hljs-string">"localhost:29092"</span>)).withGroupId(<span class="hljs-string">"group"</span>)
    )
  )

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">appLayer</span> </span>= producerLayer ++ consumerLayer
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-logging"></a><a href="#zio-logging" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Logging</h2>
<p><a href="https://github.com/zio/zio-logging">ZIO Logging</a> is simple logging for ZIO apps, with correlation, context, and pluggable backends out of the box.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-6"></a><a href="#introduction-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>When we are writing our applications using ZIO effects, to log easy way we need a ZIO native solution for logging. ZIO Logging is an environmental effect for adding logging into our ZIO applications.</p>
<p>Key features of ZIO Logging:</p>
<ul>
<li><strong>ZIO Native</strong> — Other than it is a type-safe and purely functional solution, it leverages ZIO's features.</li>
<li><strong>Multi-Platform</strong> - It supports both JVM and JS platforms.</li>
<li><strong>Composable</strong> — Loggers are composable together via contraMap.</li>
<li><strong>Pluggable Backends</strong> — Support multiple backends like ZIO Console, SLF4j, JS Console, JS HTTP endpoint.</li>
<li><strong>Logger Context</strong> — It has a first citizen <em>Logger Context</em> implemented on top of <code>FiberRef</code>. The Logger Context maintains information like logger name, filters, correlation id, and so forth across different fibers. It supports <em>Mapped Diagnostic Context (MDC)</em> which manages contextual information across fibers in a concurrent environment.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-7"></a><a href="#installation-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-config"</span> % <span class="hljs-string">"0.5.11"</span> 
</code></pre>
<p>There are also some optional dependencies:</p>
<ul>
<li><strong>zio-logging-slf4j</strong> — SLF4j integration</li>
<li><strong>zio-logging-slf4j-bridge</strong> — Using ZIO Logging for SLF4j loggers, usually third-party non-ZIO libraries</li>
<li><strong>zio-logging-jsconsole</strong> — Scala.js console integration</li>
<li><strong>zio-logging-jshttp</strong> — Scala.js HTTP Logger which sends logs to a backend via Ajax POST</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="example-7"></a><a href="#example-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's try an example of ZIO Logging which demonstrates a simple application of ZIO logging along with its <em>Logger Context</em> feature:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.duration.durationInt
<span class="hljs-keyword">import</span> zio.logging._
<span class="hljs-keyword">import</span> zio.random.<span class="hljs-type">Random</span>
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">NonEmptyChunk</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIOLoggingExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">val</span> myApp: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Logging</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Clock</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Random</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">Unit</span>] =
    <span class="hljs-keyword">for</span> {
      _ &lt;- log.info(<span class="hljs-string">"Hello from ZIO logger"</span>)
      _ &lt;-
        <span class="hljs-type">ZIO</span>.foreachPar(<span class="hljs-type">NonEmptyChunk</span>(<span class="hljs-string">"UserA"</span>, <span class="hljs-string">"UserB"</span>, <span class="hljs-string">"UserC"</span>)) { user =&gt;
          log.locally(<span class="hljs-type">UserId</span>(<span class="hljs-type">Some</span>(user))) {
            <span class="hljs-keyword">for</span> {
              _ &lt;- log.info(<span class="hljs-string">"User validation"</span>)
              _ &lt;- zio.random
                .nextIntBounded(<span class="hljs-number">1000</span>)
                .flatMap(t =&gt; <span class="hljs-type">ZIO</span>.sleep(t.millis))
              _ &lt;- log.info(<span class="hljs-string">"Connecting to the database"</span>)
              _ &lt;- zio.random
                .nextIntBounded(<span class="hljs-number">100</span>)
                .flatMap(t =&gt; <span class="hljs-type">ZIO</span>.sleep(t.millis))
              _ &lt;- log.info(<span class="hljs-string">"Releasing resources."</span>)
            } <span class="hljs-keyword">yield</span> ()
          }

        }
    } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">UserId</span> </span>= <span class="hljs-type">String</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">UserId</span></span>: <span class="hljs-type">LogAnnotation</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">UserId</span>]] = <span class="hljs-type">LogAnnotation</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">UserId</span>]](
    name = <span class="hljs-string">"user-id"</span>,
    initialValue = <span class="hljs-type">None</span>,
    combine = (_, r) =&gt; r,
    render = _.map(userId =&gt; <span class="hljs-string">s"[user-id: <span class="hljs-subst">$userId</span>]"</span>)
      .getOrElse(<span class="hljs-string">"undefined-user-id"</span>)
  )

  <span class="hljs-keyword">val</span> env =
    <span class="hljs-type">Logging</span>.console(
      logLevel = <span class="hljs-type">LogLevel</span>.<span class="hljs-type">Info</span>,
      format =
        <span class="hljs-type">LogFormat</span>.<span class="hljs-type">ColoredLogFormat</span>((ctx, line) =&gt; <span class="hljs-string">s"<span class="hljs-subst">${ctx(UserId)}</span> <span class="hljs-subst">$line</span>"</span>)
    ) &gt;&gt;&gt; <span class="hljs-type">Logging</span>.withRootLoggerName(<span class="hljs-string">"MyZIOApp"</span>)

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]) =
    myApp.provideCustomLayer(env).as(<span class="hljs-type">ExitCode</span>.success)
}
</code></pre>
<p>The output should be something like this:</p>
<pre><code class="hljs"><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">47.457</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] undefined-user-id Hello <span class="hljs-keyword">from</span> ZIO logger
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">47.807</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserA] User validation
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">47.808</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserC] User validation
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">47.818</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserB] User validation
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">48.290</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserC] Connecting to the database
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">48.299</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserA] Connecting to the database
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">48.321</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserA] Releasing resources.
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">48.352</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserC] Releasing resources.
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">48.820</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserB] Connecting to the database
<span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-09</span> <span class="hljs-number">00</span>:<span class="hljs-number">14</span>:<span class="hljs-number">48.882</span>+<span class="hljs-number">0000</span>  info [MyZIOApp] [user-id: UserB] Releasing resources.
</code></pre>
<p><a href="https://github.com/zio/zio-metrics">ZIO Metrcis</a> is a high-performance, purely-functional library for adding instrumentation to any application, with a simple web client and JMX support.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-7"></a><a href="#introduction-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>ZIO Metrics is a pure-ZIO StatsD/DogStatsD client and a thin wrapper over both <em><a href="https://github.com/prometheus/client_java">Prometheus</a></em> and <em><a href="https://metrics.dropwizard.io/4.2.0/manual/core.html">Dropwizard</a></em> instrumentation libraries allowing us to measure the behavior of our application in a performant purely functional manner.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-8"></a><a href="#installation-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to one of the following lines in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala"><span class="hljs-comment">// Prometheus</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-metrics-prometheus"</span> % <span class="hljs-string">"1.0.12"</span>

<span class="hljs-comment">// Dropwizard</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-metrics-dropwizard"</span> % <span class="hljs-string">"1.0.12"</span>

<span class="hljs-comment">// StatsD/DogStatsD</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-metrics-statsd"</span> % <span class="hljs-string">"1.0.12"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-8"></a><a href="#example-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this example we are using <code>zio-metrics-prometheus</code> module. Other that initializing default exporters, we register a counter to the registry:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.<span class="hljs-type">Runtime</span>
<span class="hljs-keyword">import</span> zio.console.{<span class="hljs-type">Console</span>, putStrLn}
<span class="hljs-keyword">import</span> zio.metrics.prometheus._
<span class="hljs-keyword">import</span> zio.metrics.prometheus.exporters._
<span class="hljs-keyword">import</span> zio.metrics.prometheus.helpers._

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIOMetricsExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">scala</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">val</span> myApp =
    <span class="hljs-keyword">for</span> {
      r &lt;- getCurrentRegistry()
      _ &lt;- initializeDefaultExports(r)
      c &lt;- counter.register(<span class="hljs-string">"ServiceA"</span>, <span class="hljs-type">Array</span>(<span class="hljs-string">"Request"</span>, <span class="hljs-string">"Region"</span>))
      _ &lt;- c.inc(<span class="hljs-number">1.0</span>, <span class="hljs-type">Array</span>(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"us-west-*"</span>))
      _ &lt;- c.inc(<span class="hljs-number">2.0</span>, <span class="hljs-type">Array</span>(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"eu-south-*"</span>))
      _ &lt;- c.inc(<span class="hljs-number">3.0</span>, <span class="hljs-type">Array</span>(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"eu-south-*"</span>))
      s &lt;- http(r, <span class="hljs-number">9090</span>)
      _ &lt;- putStrLn(<span class="hljs-string">s"The application's metric endpoint: http://localhost:<span class="hljs-subst">${s.getPort}</span>/"</span>)
    } <span class="hljs-keyword">yield</span> s

  <span class="hljs-type">Runtime</span>
    .unsafeFromLayer(
      <span class="hljs-type">Registry</span>.live ++ <span class="hljs-type">Exporters</span>.live ++ <span class="hljs-type">Console</span>.live
    )
    .unsafeRun(myApp)
}
</code></pre>
<p>Now, the application's metrics are accessible via <code>http://localhost:9090</code> endpoint.</p>
<h2><a class="anchor" aria-hidden="true" id="zio-nio"></a><a href="#zio-nio" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO NIO</h2>
<p><a href="https://zio.github.io/zio-nio/">ZIO NIO</a> is a small, unopinionated ZIO interface to NIO.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-8"></a><a href="#introduction-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>In Java, there are two packages for I/O operations:</p>
<ol>
<li><p>Java IO (<code>java.io</code>)</p>
<ul>
<li>Standard Java IO API</li>
<li>Introduced since Java 1.0</li>
<li>Stream-based API</li>
<li><strong>Blocking I/O operation</strong></li>
</ul></li>
<li><p>Java NIO (<code>java.nio</code>)</p>
<ul>
<li>Introduced since Java 1.4</li>
<li>NIO means <em>New IO</em>, an alternative to the standard Java IO API</li>
<li>It can operate in a <strong>non-blocking mode</strong> if possible</li>
<li>Buffer-based API</li>
</ul></li>
</ol>
<p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/package-summary.html">Java NIO</a> is an alternative to the Java IO API. Because it supports non-blocking IO, it can be more performant in concurrent environments like web services.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-9"></a><a href="#installation-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>ZIO NIO is a ZIO wrapper on Java NIO. It comes in two flavors:</p>
<ul>
<li><strong><code>zio.nio.core</code></strong> — a small and unopionanted ZIO interface to NIO that just wraps NIO API in ZIO effects,</li>
<li><strong><code>zio.nio</code></strong> — an opinionated interface with deeper ZIO integration that provides more type and resource safety.</li>
</ul>
<p>In order to use this library, we need to add one of the following lines in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-nio-core"</span> % <span class="hljs-string">"1.0.0-RC11"</span>
libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-nio"</span>      % <span class="hljs-string">"1.0.0-RC11"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-9"></a><a href="#example-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's try writing a simple server using <code>zio-nio</code> module:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio._
<span class="hljs-keyword">import</span> zio.console._
<span class="hljs-keyword">import</span> zio.nio.channels._
<span class="hljs-keyword">import</span> zio.nio.core._
<span class="hljs-keyword">import</span> zio.stream._

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIONIOServerExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">val</span> myApp =
    <span class="hljs-type">AsynchronousServerSocketChannel</span>()
      .use(socket =&gt;
        <span class="hljs-keyword">for</span> {
          addr &lt;- <span class="hljs-type">InetSocketAddress</span>.hostName(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">8080</span>)
          _ &lt;- socket.bindTo(addr)
          _ &lt;- putStrLn(<span class="hljs-string">s"Waiting for incoming connections on <span class="hljs-subst">$addr</span> endpoint"</span>).orDie
          _ &lt;- <span class="hljs-type">ZStream</span>
            .repeatEffect(socket.accept.preallocate)
            .map(_.withEarlyRelease)
            .mapMPar(<span class="hljs-number">16</span>) {
              _.use { <span class="hljs-keyword">case</span> (closeConn, channel) =&gt;
                <span class="hljs-keyword">for</span> {
                  _ &lt;- putStrLn(<span class="hljs-string">"Received connection"</span>).orDie
                  data &lt;- <span class="hljs-type">ZStream</span>
                    .repeatEffectOption(
                      channel.readChunk(<span class="hljs-number">64</span>).eofCheck.orElseFail(<span class="hljs-type">None</span>)
                    )
                    .flattenChunks
                    .transduce(<span class="hljs-type">ZTransducer</span>.utf8Decode)
                    .run(<span class="hljs-type">Sink</span>.foldLeft(<span class="hljs-string">""</span>)(_ + _))
                  _ &lt;- closeConn
                  _ &lt;- putStrLn(<span class="hljs-string">s"Request Received:\n<span class="hljs-subst">${data.mkString}</span>"</span>).orDie
                } <span class="hljs-keyword">yield</span> ()
              }
            }.runDrain
        } <span class="hljs-keyword">yield</span> ()
      ).orDie
   
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    myApp.exitCode
}
</code></pre>
<p>Now we can send our requests to the server using <em>curl</em> command:</p>
<pre><code class="hljs">curl -X POST <span class="hljs-string">localhost:</span><span class="hljs-number">8080</span> -d <span class="hljs-string">"Hello, ZIO NIO!"</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-optics"></a><a href="#zio-optics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Optics</h2>
<p><a href="https://github.com/zio/zio-optics">ZIO Optics</a> is a library that makes it easy to modify parts of larger data structures based on a single representation of an optic as a combination of a getter and setter.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-9"></a><a href="#introduction-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>When we are working with immutable nested data structures, updating and reading operations could be tedious with lots of boilerplates. Optics is a functional programming construct that makes these operations more clear and readable.</p>
<p>Key features of ZIO Optics:</p>
<ul>
<li><strong>Unified Optic Data Type</strong> — All the data types like <code>Lens</code>, <code>Prism</code>, <code>Optional</code>, and so forth are type aliases for the core <code>Optic</code> data type.</li>
<li><strong>Composability</strong> — We can compose optics to create more advanced ones.</li>
<li><strong>Embracing the Tremendous Power of Concretion</strong> — Using concretion instead of unnecessary abstractions, makes the API more ergonomic and easy to use.</li>
<li><strong>Integration with ZIO Data Types</strong> — It supports effectful and transactional optics that works with ZIO data structures like <code>Ref</code> and <code>TMap</code>.</li>
<li><strong>Helpful Error Channel</strong> — Like ZIO, the <code>Optics</code> data type has error channels to include failure details.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-10"></a><a href="#installation-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-optics"</span> % <span class="hljs-string">"0.1.0"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-10"></a><a href="#example-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this example, we are going to update a nested data structure using ZIO Optics:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.optics._

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Developer</span>(<span class="hljs-params">name: <span class="hljs-type">String</span>, manager: <span class="hljs-type">Manager</span></span>)</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>(<span class="hljs-params">name: <span class="hljs-type">String</span>, rating: <span class="hljs-type">Rating</span></span>)</span>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rating</span>(<span class="hljs-params">upvotes: <span class="hljs-type">Int</span>, downvotes: <span class="hljs-type">Int</span></span>)</span>

<span class="hljs-keyword">val</span> developerLens = <span class="hljs-type">Lens</span>[<span class="hljs-type">Developer</span>, <span class="hljs-type">Manager</span>](
  get = developer =&gt; <span class="hljs-type">Right</span>(developer.manager),
  set = manager =&gt; developer =&gt; <span class="hljs-type">Right</span>(developer.copy(manager = manager))
)

<span class="hljs-keyword">val</span> managerLens = <span class="hljs-type">Lens</span>[<span class="hljs-type">Manager</span>, <span class="hljs-type">Rating</span>](
  get = manager =&gt; <span class="hljs-type">Right</span>(manager.rating),
  set = rating =&gt; manager =&gt; <span class="hljs-type">Right</span>(manager.copy(rating = rating))
)

<span class="hljs-keyword">val</span> ratingLens = <span class="hljs-type">Lens</span>[<span class="hljs-type">Rating</span>, <span class="hljs-type">Int</span>](
  get = rating =&gt; <span class="hljs-type">Right</span>(rating.upvotes),
  set = upvotes =&gt; rating =&gt; <span class="hljs-type">Right</span>(rating.copy(upvotes = upvotes))
)

<span class="hljs-comment">// Composing lenses</span>
<span class="hljs-keyword">val</span> optic = developerLens &gt;&gt;&gt; managerLens &gt;&gt;&gt; ratingLens

<span class="hljs-keyword">val</span> jane    = <span class="hljs-type">Developer</span>(<span class="hljs-string">"Jane"</span>, <span class="hljs-type">Manager</span>(<span class="hljs-string">"Steve"</span>, <span class="hljs-type">Rating</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)))
<span class="hljs-keyword">val</span> updated = optic.update(jane)(_ + <span class="hljs-number">1</span>)

println(updated)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-prelude"></a><a href="#zio-prelude" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Prelude</h2>
<p><a href="https://github.com/zio/zio-prelude">ZIO Prelude</a> is a lightweight, distinctly Scala take on <strong>functional abstractions</strong>, with tight ZIO integration.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-10"></a><a href="#introduction-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>ZIO Prelude is a small library that brings common, useful algebraic abstractions and data types to scala developers.</p>
<p>It is an alternative to libraries like <em>Scalaz</em> and <em>Cats</em> based on radical ideas that embrace <strong>modularity</strong> and <strong>subtyping</strong> in Scala and offer <strong>new levels of power and ergonomics</strong>. It throws out the classic functor hierarchy in favor of a modular algebraic approach that is smaller, easier to understand and teach, and more expressive.</p>
<p>Design principles behind ZIO Prelude:</p>
<ol>
<li><strong>Radical</strong> — So basically it ignores all dogma and it is completely written with a new mindset.</li>
<li><strong>Orthogonality</strong> — The goal for ZIO Prelude is to have no overlap. Type classes should do one thing and fit it well. So there is not any duplication to describe type classes.</li>
<li><strong>Principled</strong> — All type classes in ZIO Prelude include a set of laws that instances must obey.</li>
<li><strong>Pragmatic</strong> — If we have data types that don't satisfy laws but that are still useful to use in most cases, we can go ahead and provide instances for them.</li>
<li><strong>Scala-First</strong> - It embraces subtyping and benefit from object-oriented features of Scala.</li>
</ol>
<p>ZIO Prelude gives us:</p>
<ul>
<li><strong>Data Types</strong> that complements the Scala Standard Library:
<ul>
<li><code>NonEmptyList</code>, <code>NonEmptySet</code></li>
<li><code>ZSet</code>, <code>ZNonEmptySet</code></li>
<li><code>Validation</code></li>
<li><code>ZPure</code></li>
</ul></li>
<li><strong>Type Classes</strong> to describe similarities across different types to eliminate duplications and boilerplates:
<ul>
<li>Business entities (<code>Person</code>, <code>ShoppingCart</code>, etc.)</li>
<li>Effect-like structures (<code>Try</code>, <code>Option</code>, <code>Future</code>, <code>Either</code>, etc.)</li>
<li>Collection-like structures (<code>List</code>, <code>Tree</code>, etc.)</li>
</ul></li>
<li><strong>New Types</strong> that allow to <em>increase type safety</em> in domain modeling. Wrapping existing type adding no runtime overhead.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-11"></a><a href="#installation-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-prelude"</span> % <span class="hljs-string">"1.0.0-RC5"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-11"></a><a href="#example-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this example, we are going to create a simple voting application. We will use two features of ZIO Prelude:</p>
<ol>
<li>To become more type safety we are going to use <em>New Types</em> and introducing <code>Topic</code> and <code>Votes</code> data types.</li>
<li>Providing instance of <code>Associative</code> type class for <code>Votes</code> data type which helps us to combine <code>Votes</code> values.</li>
</ol>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.prelude._

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">VotingExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">scala</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Votes</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Subtype</span>[<span class="hljs-type">Int</span>] </span>{
    <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">val</span> associativeVotes: <span class="hljs-type">Associative</span>[<span class="hljs-type">Votes</span>] =
      <span class="hljs-keyword">new</span> <span class="hljs-type">Associative</span>[<span class="hljs-type">Votes</span>] {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">combine</span></span>(l: =&gt; <span class="hljs-type">Votes</span>, r: =&gt; <span class="hljs-type">Votes</span>): <span class="hljs-type">Votes</span> =
          <span class="hljs-type">Votes</span>(l + r)
      }
  }
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">Votes</span> </span>= <span class="hljs-type">Votes</span>.<span class="hljs-type">Type</span>

  <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Topic</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Subtype</span>[<span class="hljs-type">String</span>]</span>
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">Topic</span> </span>= <span class="hljs-type">Topic</span>.<span class="hljs-type">Type</span>

  <span class="hljs-keyword">final</span> <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VoteState</span>(<span class="hljs-params">map: <span class="hljs-type">Map</span>[<span class="hljs-type">Topic</span>, <span class="hljs-type">Votes</span>]</span>) </span>{ self =&gt;
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">combine</span></span>(that: <span class="hljs-type">VoteState</span>): <span class="hljs-type">VoteState</span> =
      <span class="hljs-type">VoteState</span>(self.map combine that.map)
  }

  <span class="hljs-keyword">val</span> zioHttp    = <span class="hljs-type">Topic</span>(<span class="hljs-string">"zio-http"</span>)
  <span class="hljs-keyword">val</span> uziHttp    = <span class="hljs-type">Topic</span>(<span class="hljs-string">"uzi-http"</span>)
  <span class="hljs-keyword">val</span> zioTlsHttp = <span class="hljs-type">Topic</span>(<span class="hljs-string">"zio-tls-http"</span>)

  <span class="hljs-keyword">val</span> leftVotes  = <span class="hljs-type">VoteState</span>(<span class="hljs-type">Map</span>(zioHttp -&gt; <span class="hljs-type">Votes</span>(<span class="hljs-number">4</span>), uziHttp -&gt; <span class="hljs-type">Votes</span>(<span class="hljs-number">2</span>)))
  <span class="hljs-keyword">val</span> rightVotes = <span class="hljs-type">VoteState</span>(<span class="hljs-type">Map</span>(zioHttp -&gt; <span class="hljs-type">Votes</span>(<span class="hljs-number">2</span>), zioTlsHttp -&gt; <span class="hljs-type">Votes</span>(<span class="hljs-number">2</span>)))

  println(leftVotes combine rightVotes)
  <span class="hljs-comment">// Output: VoteState(Map(zio-http -&gt; 6, uzi-http -&gt; 2, zio-tls-http -&gt; 2))</span>
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-process"></a><a href="#zio-process" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Process</h2>
<p><a href="https://github.com/zio/zio-process">ZIO Process</a> is a simple ZIO library for interacting with external processes and command-line programs.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-11"></a><a href="#introduction-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>ZIO Process provides a principled way to call out to external programs from within a ZIO application while leveraging ZIO's capabilities like interruptions and offloading blocking operations to a separate thread pool. We don't need to worry about avoiding these common pitfalls as we would if we were to use Java's <code>ProcessBuilder</code> or the <code>scala.sys.process</code> API since it is already taken care of for you.</p>
<p>Key features of the ZIO Process:</p>
<ul>
<li><strong>Deep ZIO Integration</strong> — Leverages ZIO to handle interruption and offload blocking operations.</li>
<li><strong>ZIO Streams</strong> — ZIO Process is backed by ZIO Streams, which enables us to obtain the command output as streams of bytes or lines. So we can work with processes that output gigabytes of data without worrying about exceeding memory constraints.</li>
<li><strong>Descriptive Errors</strong> — In case of command failure, it has a descriptive category of errors.</li>
<li><strong>Piping</strong> — It has a simple DSL for piping the output of one command as the input of another.</li>
<li><strong>Blocking Operations</strong> —</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-12"></a><a href="#installation-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-process"</span> % <span class="hljs-string">"0.5.0"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-12"></a><a href="#example-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Here is a simple example of using ZIO Process:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.process.<span class="hljs-type">Command</span>
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">URIO</span>}

<span class="hljs-keyword">import</span> java.io.<span class="hljs-type">File</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIOProcessExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">val</span> myApp = <span class="hljs-keyword">for</span> {
    fiber &lt;- <span class="hljs-type">Command</span>(<span class="hljs-string">"dmesg"</span>, <span class="hljs-string">"--follow"</span>).linesStream
      .foreach(putStrLn(_))
      .fork
    cpuModel &lt;- (<span class="hljs-type">Command</span>(<span class="hljs-string">"cat"</span>, <span class="hljs-string">"/proc/cpuinfo"</span>) |
      <span class="hljs-type">Command</span>(<span class="hljs-string">"grep"</span>, <span class="hljs-string">"model name"</span>) |
      <span class="hljs-type">Command</span>(<span class="hljs-string">"head"</span>, <span class="hljs-string">"-n"</span>, <span class="hljs-string">"1"</span>) |
      <span class="hljs-type">Command</span>(<span class="hljs-string">"cut"</span>, <span class="hljs-string">"-d"</span>, <span class="hljs-string">":"</span>, <span class="hljs-string">"-f"</span>, <span class="hljs-string">"2"</span>)).string
    _ &lt;- putStrLn(<span class="hljs-string">s"CPU Model: <span class="hljs-subst">$cpuModel</span>"</span>)
    _ &lt;- (<span class="hljs-type">Command</span>(<span class="hljs-string">"pg_dump"</span>, <span class="hljs-string">"my_database"</span>) &gt; <span class="hljs-keyword">new</span> <span class="hljs-type">File</span>(<span class="hljs-string">"dump.sql"</span>)).exitCode
    _ &lt;- fiber.join
  } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    myApp.exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-query"></a><a href="#zio-query" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Query</h2>
<p><a href="https://github.com/zio/zio-query">ZIO Query</a> is a library for writing optimized queries to data sources in a high-level compositional style. It can add efficient pipelining, batching, and caching to any data source.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-12"></a><a href="#introduction-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>Some key features of ZIO Query:</p>
<ul>
<li><p><strong>Batching</strong> — ZIO Query detects parts of composite queries that can be executed in parallel without changing the semantics of the query.</p></li>
<li><p><strong>Pipelining</strong> — ZIO Query detects parts of composite queries that can be combined together for fewer individual requests to the data source.</p></li>
<li><p><strong>Caching</strong> — ZIO Query can transparently cache read queries to minimize the cost of fetching the same item repeatedly in the scope of a query.</p></li>
</ul>
<p>Assume we have the following database access layer APIs:</p>
<pre><code class="hljs css language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getAllUserIds</span></span>: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">List</span>[<span class="hljs-type">Int</span>]] = {
  <span class="hljs-comment">// Get all user IDs e.g. SELECT id FROM users</span>
  <span class="hljs-type">ZIO</span>.succeed(???)
}

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getUserNameById</span></span>(id: <span class="hljs-type">Int</span>): <span class="hljs-type">ZIO</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">String</span>] = {
  <span class="hljs-comment">// Get user by ID e.g. SELECT name FROM users WHERE id = $id</span>
  <span class="hljs-type">ZIO</span>.succeed(???)
}
</code></pre>
<p>We can get their corresponding usernames from the database by the following code snippet:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> userNames = <span class="hljs-keyword">for</span> {
  ids   &lt;- getAllUserIds
  names &lt;- <span class="hljs-type">ZIO</span>.foreachPar(ids)(getUserNameById)
} <span class="hljs-keyword">yield</span> names
</code></pre>
<p>It works, but this is not performant. It is going to query the underlying database <em>N + 1</em> times.</p>
<p>In this case, ZIO Query helps us to write an optimized query that is going to perform two queries (one for getting user IDs and one for getting all usernames).</p>
<h3><a class="anchor" aria-hidden="true" id="installation-13"></a><a href="#installation-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-query"</span> % <span class="hljs-string">"0.2.9"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-13"></a><a href="#example-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Here is an example of using ZIO Query, which optimizes multiple database queries by batching all of them in one query:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.query.{<span class="hljs-type">CompletedRequestMap</span>, <span class="hljs-type">DataSource</span>, <span class="hljs-type">Request</span>, <span class="hljs-type">ZQuery</span>}
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">Chunk</span>, <span class="hljs-type">ExitCode</span>, <span class="hljs-type">Task</span>, <span class="hljs-type">URIO</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-keyword">import</span> scala.collection.immutable.<span class="hljs-type">AbstractSeq</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZQueryExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetUserName</span>(<span class="hljs-params">id: <span class="hljs-type">Int</span></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">Request</span>[<span class="hljs-type">Nothing</span>, <span class="hljs-type">String</span>]</span>

  <span class="hljs-keyword">lazy</span> <span class="hljs-keyword">val</span> <span class="hljs-type">UserDataSource</span>: <span class="hljs-type">DataSource</span>.<span class="hljs-type">Batched</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">GetUserName</span>] =
    <span class="hljs-keyword">new</span> <span class="hljs-type">DataSource</span>.<span class="hljs-type">Batched</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">GetUserName</span>] {
      <span class="hljs-keyword">val</span> identifier: <span class="hljs-type">String</span> = <span class="hljs-string">"UserDataSource"</span>

      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(requests: <span class="hljs-type">Chunk</span>[<span class="hljs-type">GetUserName</span>]): <span class="hljs-type">ZIO</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">CompletedRequestMap</span>] = {
        <span class="hljs-keyword">val</span> resultMap = <span class="hljs-type">CompletedRequestMap</span>.empty
        requests.toList <span class="hljs-keyword">match</span> {
          <span class="hljs-keyword">case</span> request :: <span class="hljs-type">Nil</span> =&gt;
            <span class="hljs-keyword">val</span> result: <span class="hljs-type">Task</span>[<span class="hljs-type">String</span>] = {
              <span class="hljs-comment">// get user by ID e.g. SELECT name FROM users WHERE id = $id</span>
              <span class="hljs-type">ZIO</span>.succeed(???)
            }

            result.either.map(resultMap.insert(request))

          <span class="hljs-keyword">case</span> batch: <span class="hljs-type">Seq</span>[<span class="hljs-type">GetUserName</span>] =&gt;
            <span class="hljs-keyword">val</span> result: <span class="hljs-type">Task</span>[<span class="hljs-type">List</span>[(<span class="hljs-type">Int</span>, <span class="hljs-type">String</span>)]] = {
              <span class="hljs-comment">// get multiple users at once e.g. SELECT id, name FROM users WHERE id IN ($ids)</span>
              <span class="hljs-type">ZIO</span>.succeed(???)
            }

            result.fold(
              err =&gt;
                requests.foldLeft(resultMap) { <span class="hljs-keyword">case</span> (map, req) =&gt;
                  map.insert(req)(<span class="hljs-type">Left</span>(err))
                },
              _.foldLeft(resultMap) { <span class="hljs-keyword">case</span> (map, (id, name)) =&gt;
                map.insert(<span class="hljs-type">GetUserName</span>(id))(<span class="hljs-type">Right</span>(name))
              }
            )
        }
      }
    }

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getUserNameById</span></span>(id: <span class="hljs-type">Int</span>): <span class="hljs-type">ZQuery</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">String</span>] =
    <span class="hljs-type">ZQuery</span>.fromRequest(<span class="hljs-type">GetUserName</span>(id))(<span class="hljs-type">UserDataSource</span>)

  <span class="hljs-keyword">val</span> query: <span class="hljs-type">ZQuery</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]] =
    <span class="hljs-keyword">for</span> {
      ids &lt;- <span class="hljs-type">ZQuery</span>.succeed(<span class="hljs-number">1</span> to <span class="hljs-number">10</span>)
      names &lt;- <span class="hljs-type">ZQuery</span>.foreachPar(ids)(id =&gt; getUserNameById(id)).map(_.toList)
    } <span class="hljs-keyword">yield</span> (names)

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    query.run
      .tap(usernames =&gt; putStrLn(<span class="hljs-string">s"Usernames: <span class="hljs-subst">$usernames</span>"</span>))
      .exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-redis"></a><a href="#zio-redis" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Redis</h2>
<p><a href="https://github.com/zio/zio-redis">ZIO Redis</a> is a ZIO native Redis client.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-13"></a><a href="#introduction-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>ZIO Redis is in the experimental phase of development, but its goals are:</p>
<ul>
<li><strong>Type Safety</strong></li>
<li><strong>Performance</strong></li>
<li><strong>Minimum Dependency</strong></li>
<li><strong>ZIO Native</strong></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-14"></a><a href="#installation-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>Since the ZIO Redis is in the experimental phase, it is not released yet.</p>
<h3><a class="anchor" aria-hidden="true" id="example-14"></a><a href="#example-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>To execute our ZIO Redis effect, we should provide the <code>RedisExecutor</code> layer to that effect. To create this layer we should also provide the following layers:</p>
<ul>
<li><strong>Logging</strong> — For simplicity, we ignored the logging functionality.</li>
<li><strong>RedisConfig</strong> — Using default one, will connect to the <code>localhost:6379</code> Redis instance.</li>
<li><strong>Codec</strong> — In this example, we are going to use the built-in <code>StringUtf8Codec</code> codec.</li>
</ul>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.console.{<span class="hljs-type">Console</span>, putStrLn}
<span class="hljs-keyword">import</span> zio.duration._
<span class="hljs-keyword">import</span> zio.logging.<span class="hljs-type">Logging</span>
<span class="hljs-keyword">import</span> zio.redis._
<span class="hljs-keyword">import</span> zio.redis.codec.<span class="hljs-type">StringUtf8Codec</span>
<span class="hljs-keyword">import</span> zio.schema.codec.<span class="hljs-type">Codec</span>
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">URIO</span>, <span class="hljs-type">ZIO</span>, <span class="hljs-type">ZLayer</span>}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIORedisExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">val</span> myApp: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">RedisExecutor</span>, <span class="hljs-type">RedisError</span>, <span class="hljs-type">Unit</span>] = <span class="hljs-keyword">for</span> {
    _ &lt;- set(<span class="hljs-string">"myKey"</span>, <span class="hljs-number">8</span>L, <span class="hljs-type">Some</span>(<span class="hljs-number">1.</span>minutes))
    v &lt;- get[<span class="hljs-type">String</span>, <span class="hljs-type">Long</span>](<span class="hljs-string">"myKey"</span>)
    _ &lt;- putStrLn(<span class="hljs-string">s"Value of myKey: <span class="hljs-subst">$v</span>"</span>).orDie
    _ &lt;- hSet(<span class="hljs-string">"myHash"</span>, (<span class="hljs-string">"k1"</span>, <span class="hljs-number">6</span>), (<span class="hljs-string">"k2"</span>, <span class="hljs-number">2</span>))
    _ &lt;- rPush(<span class="hljs-string">"myList"</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
    _ &lt;- sAdd(<span class="hljs-string">"mySet"</span>, <span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"a"</span>, <span class="hljs-string">"c"</span>)
  } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-keyword">val</span> layer: <span class="hljs-type">ZLayer</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">RedisError</span>.<span class="hljs-type">IOError</span>, <span class="hljs-type">RedisExecutor</span>] =
    <span class="hljs-type">Logging</span>.ignore ++ <span class="hljs-type">ZLayer</span>.succeed(<span class="hljs-type">RedisConfig</span>.<span class="hljs-type">Default</span>) ++ <span class="hljs-type">ZLayer</span>.succeed(<span class="hljs-type">StringUtf8Codec</span>) &gt;&gt;&gt; <span class="hljs-type">RedisExecutor</span>.live

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    myApp.provideCustomLayer(layer).exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-rocksdb"></a><a href="#zio-rocksdb" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO RocksDB</h2>
<p><a href="https://github.com/zio/zio-rocksdb">ZIO RocksDB</a> is a ZIO-based interface to RocksDB.</p>
<p>Rocksdb is an embeddable persistent key-value store that is optimized for fast storage. ZIO RocksDB provides us a functional ZIO wrapper around its Java API.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-15"></a><a href="#installation-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-rocksdb"</span> % <span class="hljs-string">"0.3.0"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-15"></a><a href="#example-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>An example of writing and reading key/value pairs and also using transactional operations when using RocksDB:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.console._
<span class="hljs-keyword">import</span> zio.rocksdb.{<span class="hljs-type">RocksDB</span>, <span class="hljs-type">Transaction</span>, <span class="hljs-type">TransactionDB</span>}
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">URIO</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-keyword">import</span> java.nio.charset.<span class="hljs-type">StandardCharsets</span>._

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIORocksDBExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bytesToString</span></span>(bytes: <span class="hljs-type">Array</span>[<span class="hljs-type">Byte</span>]): <span class="hljs-type">String</span> = <span class="hljs-keyword">new</span> <span class="hljs-type">String</span>(bytes, <span class="hljs-type">UTF_8</span>)
  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bytesToInt</span></span>(bytes: <span class="hljs-type">Array</span>[<span class="hljs-type">Byte</span>]): <span class="hljs-type">Int</span> = bytesToString(bytes).toInt

  <span class="hljs-keyword">val</span> job1: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">RocksDB</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Unit</span>] =
    <span class="hljs-keyword">for</span> {
      _ &lt;- <span class="hljs-type">RocksDB</span>.put(
        <span class="hljs-string">"Key"</span>.getBytes(<span class="hljs-type">UTF_8</span>),
        <span class="hljs-string">"Value"</span>.getBytes(<span class="hljs-type">UTF_8</span>)
      )
      result &lt;- <span class="hljs-type">RocksDB</span>.get(<span class="hljs-string">"Key"</span>.getBytes(<span class="hljs-type">UTF_8</span>))
      stringResult = result.map(bytesToString)
      _ &lt;- putStrLn(<span class="hljs-string">s"value: <span class="hljs-subst">$stringResult</span>"</span>)
    } <span class="hljs-keyword">yield</span> ()


  <span class="hljs-keyword">val</span> job2: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">TransactionDB</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Unit</span>] =
    <span class="hljs-keyword">for</span> {
      key &lt;- <span class="hljs-type">ZIO</span>.succeed(<span class="hljs-string">"COUNT"</span>.getBytes(<span class="hljs-type">UTF_8</span>))
      _ &lt;- <span class="hljs-type">TransactionDB</span>.put(key, <span class="hljs-number">0.</span>toString.getBytes(<span class="hljs-type">UTF_8</span>))
      _ &lt;- <span class="hljs-type">ZIO</span>.foreachPar(<span class="hljs-number">0</span> until <span class="hljs-number">10</span>) { _ =&gt;
        <span class="hljs-type">TransactionDB</span>.atomically {
          <span class="hljs-type">Transaction</span>.getForUpdate(key, exclusive = <span class="hljs-literal">true</span>) &gt;&gt;= { iCount =&gt;
            <span class="hljs-type">Transaction</span>.put(key, iCount.map(bytesToInt).map(_ + <span class="hljs-number">1</span>).getOrElse(<span class="hljs-number">-1</span>).toString.getBytes(<span class="hljs-type">UTF_8</span>))
          }
        }
      }
      value &lt;- <span class="hljs-type">TransactionDB</span>.get(key)
      counterValue = value.map(bytesToInt)
      _ &lt;- putStrLn(<span class="hljs-string">s"The value of counter: <span class="hljs-subst">$counterValue</span>"</span>) <span class="hljs-comment">// Must be 10</span>
    } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> transactional_db =
    <span class="hljs-type">TransactionDB</span>.live(<span class="hljs-keyword">new</span> org.rocksdb.<span class="hljs-type">Options</span>().setCreateIfMissing(<span class="hljs-literal">true</span>), <span class="hljs-string">"tr_db"</span>)

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> rocks_db =
    <span class="hljs-type">RocksDB</span>.live(<span class="hljs-keyword">new</span> org.rocksdb.<span class="hljs-type">Options</span>().setCreateIfMissing(<span class="hljs-literal">true</span>), <span class="hljs-string">"rocks_db"</span>)

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">Int</span>] =
    (job1 &lt;*&gt; job2)
      .provideCustomLayer(transactional_db ++ rocks_db)
      .foldCauseM(cause =&gt; putStrLn(cause.prettyPrint) *&gt; <span class="hljs-type">ZIO</span>.succeed(<span class="hljs-number">1</span>), _ =&gt; <span class="hljs-type">ZIO</span>.succeed(<span class="hljs-number">0</span>))
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-s3"></a><a href="#zio-s3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO S3</h2>
<p><a href="https://github.com/zio/zio-s3">ZIO S3</a> is an S3 client for ZIO.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-16"></a><a href="#installation-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-s3"</span> % <span class="hljs-string">"0.3.5"</span> 
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-16"></a><a href="#example-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>Let's try an example of creating a bucket and adding an object into it. To run this example, we need to run an instance of <em>Minio</em> which is object storage compatible with S3:</p>
<pre><code class="hljs css language-bash">docker run -p 9000:9000 -e MINIO_ACCESS_KEY=MyKey -e MINIO_SECRET_KEY=MySecret minio/minio  server --compat /data
</code></pre>
<p>In this example we create a bucket and then add a JSON object to it and then retrieve that:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> software.amazon.awssdk.auth.credentials.<span class="hljs-type">AwsBasicCredentials</span>
<span class="hljs-keyword">import</span> software.amazon.awssdk.regions.<span class="hljs-type">Region</span>
<span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.s3._
<span class="hljs-keyword">import</span> zio.stream.{<span class="hljs-type">ZStream</span>, <span class="hljs-type">ZTransducer</span>}
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">Chunk</span>, <span class="hljs-type">ExitCode</span>, <span class="hljs-type">URIO</span>}

<span class="hljs-keyword">import</span> java.net.<span class="hljs-type">URI</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZIOS3Example</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">val</span> myApp = <span class="hljs-keyword">for</span> {
    _ &lt;- createBucket(<span class="hljs-string">"docs"</span>)
    json = <span class="hljs-type">Chunk</span>.fromArray(<span class="hljs-string">""</span><span class="hljs-string">"{  "</span><span class="hljs-string">id" : 1 , "</span><span class="hljs-string">name" : "</span><span class="hljs-type">A1</span><span class="hljs-string">" }"</span><span class="hljs-string">""</span>.getBytes)
    _ &lt;- putObject(
      bucketName = <span class="hljs-string">"docs"</span>,
      key = <span class="hljs-string">"doc1"</span>,
      contentLength = json.length,
      content = <span class="hljs-type">ZStream</span>.fromChunk(json),
      options = <span class="hljs-type">UploadOptions</span>.fromContentType(<span class="hljs-string">"application/json"</span>)
    )
    _ &lt;- getObject(<span class="hljs-string">"docs"</span>, <span class="hljs-string">"doc1"</span>)
      .transduce(<span class="hljs-type">ZTransducer</span>.utf8Decode)
      .foreach(putStrLn(_))
  } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    myApp
      .provideCustomLayer(
        live(
          <span class="hljs-type">Region</span>.<span class="hljs-type">CA_CENTRAL_1</span>,
          <span class="hljs-type">AwsBasicCredentials</span>.create(<span class="hljs-string">"MyKey"</span>, <span class="hljs-string">"MySecret"</span>),
          <span class="hljs-type">Some</span>(<span class="hljs-type">URI</span>.create(<span class="hljs-string">"http://localhost:9000"</span>))
        )
      )
      .exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-schema"></a><a href="#zio-schema" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Schema</h2>
<p><a href="https://github.com/zio/zio-schema">ZIO Schema</a> is a <a href="https://zio.dev">ZIO</a>-based library for modeling the schema of data structures as first-class values.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-14"></a><a href="#introduction-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>Schema is a structure of a data type. ZIO Schema reifies the concept of structure for data types. It makes a high-level description of any data type and makes them as first-class values.</p>
<p>Creating a schema for a data type helps us to write codecs for that data type. So this library can be a host of functionalities useful for writing codecs and protocols like JSON, Protobuf, CSV, and so forth.</p>
<p>With schema descriptions that can be automatically derived for case classes and sealed traits, <em>ZIO Schema</em> will be going to provide powerful features for free (Note that the project is in the development stage and all these features are not supported yet):</p>
<ul>
<li>Codecs for any supported protocol (JSON, protobuf, etc.), so data structures can be serialized and deserialized in a principled way</li>
<li>Diffing, patching, merging, and other generic-data-based operations</li>
<li>Migration of data structures from one schema to another compatible schema</li>
<li>Derivation of arbitrary type classes (<code>Eq</code>, <code>Show</code>, <code>Ord</code>, etc.) from the structure of the data</li>
</ul>
<p>When our data structures need to be serialized, deserialized, persisted, or transported across the wire, then <em>ZIO Schema</em> lets us focus on data modeling and automatically tackle all the low-level, messy details for us.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-17"></a><a href="#installation-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-schema"</span> % <span class="hljs-string">"0.0.6"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-17"></a><a href="#example-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this simple example first, we create a schema for <code>Person</code> and then run the <em>diff</em> operation on two instances of the <code>Person</code> data type, and finally we encode a Person instance using <em>Protobuf</em> protocol:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio.console.putStrLn
<span class="hljs-keyword">import</span> zio.schema.codec.<span class="hljs-type">ProtobufCodec</span>._
<span class="hljs-keyword">import</span> zio.schema.{<span class="hljs-type">DeriveSchema</span>, <span class="hljs-type">Schema</span>}
<span class="hljs-keyword">import</span> zio.stream.<span class="hljs-type">ZStream</span>
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">Chunk</span>, <span class="hljs-type">ExitCode</span>, <span class="hljs-type">URIO</span>}

<span class="hljs-keyword">final</span> <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name: <span class="hljs-type">String</span>, age: <span class="hljs-type">Int</span>, id: <span class="hljs-type">String</span></span>)</span>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Person</span> </span>{
  <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">val</span> schema: <span class="hljs-type">Schema</span>[<span class="hljs-type">Person</span>] = <span class="hljs-type">DeriveSchema</span>.gen[<span class="hljs-type">Person</span>]
}

<span class="hljs-type">Person</span>.schema
<span class="hljs-comment">// res5: Schema[Person] = CaseClass3(</span>
<span class="hljs-comment">//   annotations = IndexedSeq(),</span>
<span class="hljs-comment">//   field1 = Field(</span>
<span class="hljs-comment">//     label = "name",</span>
<span class="hljs-comment">//     schema = Lazy(</span>
<span class="hljs-comment">//       schema0 = zio.schema.DeriveSchema$$$Lambda$22341/1053136711@555717a6</span>
<span class="hljs-comment">//     ),</span>
<span class="hljs-comment">//     annotations = IndexedSeq()</span>
<span class="hljs-comment">//   ),</span>
<span class="hljs-comment">//   field2 = Field(</span>
<span class="hljs-comment">//     label = "age",</span>
<span class="hljs-comment">//     schema = Lazy(</span>
<span class="hljs-comment">//       schema0 = zio.schema.DeriveSchema$$$Lambda$22342/2078605595@2eca5020</span>
<span class="hljs-comment">//     ),</span>
<span class="hljs-comment">//     annotations = IndexedSeq()</span>
<span class="hljs-comment">//   ),</span>
<span class="hljs-comment">//   field3 = Field(</span>
<span class="hljs-comment">//     label = "id",</span>
<span class="hljs-comment">//     schema = Lazy(</span>
<span class="hljs-comment">//       schema0 = zio.schema.DeriveSchema$$$Lambda$22343/1762184847@20cff826</span>
<span class="hljs-comment">//     ),</span>
<span class="hljs-comment">//     annotations = IndexedSeq()</span>
<span class="hljs-comment">//   ),</span>
<span class="hljs-comment">//   construct = zio.schema.DeriveSchema$$$Lambda$22344/1207468103@4172a4d2,</span>
<span class="hljs-comment">//   extractField1 = zio.schema.DeriveSchema$$$Lambda$22345/348564602@2c75617d,</span>
<span class="hljs-comment">//   extractField2 = zio.schema.DeriveSchema$$$Lambda$22346/999646427@50426f83,</span>
<span class="hljs-comment">//   extractField3 = zio.schema.DeriveSchema$$$Lambda$22347/1577358436@f13b365</span>
<span class="hljs-comment">// )</span>

<span class="hljs-keyword">import</span> zio.schema.syntax._

<span class="hljs-type">Person</span>(<span class="hljs-string">"Alex"</span>, <span class="hljs-number">31</span>, <span class="hljs-string">"0123"</span>).diff(<span class="hljs-type">Person</span>(<span class="hljs-string">"Alex"</span>, <span class="hljs-number">31</span>, <span class="hljs-string">"124"</span>))
<span class="hljs-comment">// res6: schema.Diff = Record(</span>
<span class="hljs-comment">//   differences = ListMap(</span>
<span class="hljs-comment">//     "name" -&gt; Identical,</span>
<span class="hljs-comment">//     "age" -&gt; Identical,</span>
<span class="hljs-comment">//     "id" -&gt; Myers(</span>
<span class="hljs-comment">//       edits = IndexedSeq(</span>
<span class="hljs-comment">//         Delete(s = "0"),</span>
<span class="hljs-comment">//         Keep(s = "1"),</span>
<span class="hljs-comment">//         Keep(s = "2"),</span>
<span class="hljs-comment">//         Insert(s = "4"),</span>
<span class="hljs-comment">//         Delete(s = "3")</span>
<span class="hljs-comment">//       )</span>
<span class="hljs-comment">//     )</span>
<span class="hljs-comment">//   )</span>
<span class="hljs-comment">// )</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toHex</span></span>(chunk: <span class="hljs-type">Chunk</span>[<span class="hljs-type">Byte</span>]): <span class="hljs-type">String</span> =
  chunk.toArray.map(<span class="hljs-string">"%02X"</span>.format(_)).mkString

zio.<span class="hljs-type">Runtime</span>.<span class="hljs-keyword">default</span>.unsafeRun(
  <span class="hljs-type">ZStream</span>
    .succeed(<span class="hljs-type">Person</span>(<span class="hljs-string">"Thomas"</span>, <span class="hljs-number">23</span>, <span class="hljs-string">"2354"</span>))
    .transduce(
      encoder(<span class="hljs-type">Person</span>.schema)
    )
    .runCollect
    .flatMap(x =&gt; putStrLn(<span class="hljs-string">s"Encoded data with protobuf codec: <span class="hljs-subst">${toHex(x)}</span>"</span>))
)
<span class="hljs-comment">// Encoded data with protobuf codec: 0A0654686F6D617310171A0432333534</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-sqs"></a><a href="#zio-sqs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO SQS</h2>
<p><a href="https://github.com/zio/zio-sqs">ZIO SQS</a> is a ZIO-powered client for AWS SQS. It is built on top of the <a href="https://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/basics.html">AWS SDK for Java 2.0</a> via the automatically generated wrappers from <a href="https://gaithub.com/vigoo/zio-aws">zio-aws</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-15"></a><a href="#introduction-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>ZIO SQS enables us to produce and consume elements to/from the Amazon SQS service. It is integrated with ZIO Streams, so we can produce and consume elements in a streaming fashion, element by element or micro-batching.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-18"></a><a href="#installation-18" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-sqs"</span> % <span class="hljs-string">"0.4.2"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-18"></a><a href="#example-18" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this example we produce a stream of events to the <code>MyQueue</code> and then consume them from that queue:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.github.vigoo.zioaws
<span class="hljs-keyword">import</span> io.github.vigoo.zioaws.core.config.<span class="hljs-type">CommonAwsConfig</span>
<span class="hljs-keyword">import</span> io.github.vigoo.zioaws.sqs.<span class="hljs-type">Sqs</span>
<span class="hljs-keyword">import</span> software.amazon.awssdk.auth.credentials.{
  <span class="hljs-type">AwsBasicCredentials</span>,
  <span class="hljs-type">StaticCredentialsProvider</span>
}
<span class="hljs-keyword">import</span> software.amazon.awssdk.regions.<span class="hljs-type">Region</span>
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.sqs.producer.{<span class="hljs-type">Producer</span>, <span class="hljs-type">ProducerEvent</span>}
<span class="hljs-keyword">import</span> zio.sqs.serialization.<span class="hljs-type">Serializer</span>
<span class="hljs-keyword">import</span> zio.sqs.{<span class="hljs-type">SqsStream</span>, <span class="hljs-type">SqsStreamSettings</span>, <span class="hljs-type">Utils</span>}
<span class="hljs-keyword">import</span> zio.stream.<span class="hljs-type">ZStream</span>
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">RIO</span>, <span class="hljs-type">URIO</span>, <span class="hljs-type">ZLayer</span>, _}

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ProducerConsumerExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{
  <span class="hljs-keyword">val</span> queueName = <span class="hljs-string">"MyQueue"</span>

  <span class="hljs-keyword">val</span> client: <span class="hljs-type">ZLayer</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Sqs</span>] = zioaws.netty.<span class="hljs-keyword">default</span> ++
    <span class="hljs-type">ZLayer</span>.succeed(
      <span class="hljs-type">CommonAwsConfig</span>(
        region = <span class="hljs-type">Some</span>(<span class="hljs-type">Region</span>.of(<span class="hljs-string">"ap-northeast-2"</span>)),
        credentialsProvider = <span class="hljs-type">StaticCredentialsProvider</span>.create(
          <span class="hljs-type">AwsBasicCredentials</span>.create(<span class="hljs-string">"key"</span>, <span class="hljs-string">"key"</span>)
        ),
        endpointOverride = <span class="hljs-type">None</span>,
        commonClientConfig = <span class="hljs-type">None</span>
      )
    ) &gt;&gt;&gt;
    zioaws.core.config.configured() &gt;&gt;&gt;
    zioaws.sqs.live

  <span class="hljs-keyword">val</span> stream: <span class="hljs-type">ZStream</span>[<span class="hljs-type">Any</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">ProducerEvent</span>[<span class="hljs-type">String</span>]] =
    <span class="hljs-type">ZStream</span>.iterate(<span class="hljs-number">0</span>)(_ + <span class="hljs-number">1</span>).map(_.toString).map(<span class="hljs-type">ProducerEvent</span>(_))

  <span class="hljs-keyword">val</span> program: <span class="hljs-type">RIO</span>[<span class="hljs-type">Sqs</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Clock</span>, <span class="hljs-type">Unit</span>] = <span class="hljs-keyword">for</span> {
    _        &lt;- <span class="hljs-type">Utils</span>.createQueue(queueName)
    queueUrl &lt;- <span class="hljs-type">Utils</span>.getQueueUrl(queueName)
    producer = <span class="hljs-type">Producer</span>.make(queueUrl, <span class="hljs-type">Serializer</span>.serializeString)
    _ &lt;- producer.use { p =&gt;
      p.sendStream(stream).runDrain
    }
    _ &lt;- <span class="hljs-type">SqsStream</span>(
      queueUrl,
      <span class="hljs-type">SqsStreamSettings</span>(stopWhenQueueEmpty = <span class="hljs-literal">true</span>, waitTimeSeconds = <span class="hljs-type">Some</span>(<span class="hljs-number">3</span>))
    ).foreach(msg =&gt; <span class="hljs-type">UIO</span>(println(msg.body)))
  } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[zio.<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    program.provideCustomLayer(client).exitCode
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="zio-telemetry"></a><a href="#zio-telemetry" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO Telemetry</h2>
<p><a href="https://github.com/zio/zio-telemetry">ZIO telemetry</a> is purely-functional and type-safe. It provides clients for OpenTracing and OpenTelemetry.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-16"></a><a href="#introduction-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>In monolithic architecture, everything is in one place, and we know when a request starts and then how it goes through the components and when it finishes. We can obviously see what is happening with our request and where is it going. But, in distributed systems like microservice architecture, we cannot find out the story of a request through various services easily. This is where distributed tracing comes into play.</p>
<p>ZIO Telemetry is a purely functional client which helps up propagate context between services in a distributed environment.</p>
<h3><a class="anchor" aria-hidden="true" id="installation-19"></a><a href="#installation-19" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file if we want to use <a href="https://opentelemetry.io/">OpenTelemetry</a> client:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-telemetry"</span> % <span class="hljs-string">"0.8.1"</span>
</code></pre>
<p>And for using <a href="https://opentracing.io/">OpenTracing</a> client we should add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-opentracing"</span> % <span class="hljs-string">"0.8.1"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-19"></a><a href="#example-19" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>In this example, we create two services, <code>ProxyServer</code> and <code>BackendServer</code>. When we call ProxyServer, the BackendServer will be called.</p>
<p>Note that we are going to use <em>OpenTracing</em> client for this example.</p>
<p>Here is a simplified diagram of our services:</p>
<pre><code class="hljs">                               ┌────────────────┐
                               │                │
                        ┌─────►│ Jaeger Backend │◄────┐
                        │      │                │     │
           Tracing Data │      └────────────────┘     │ Tracing Data
                        │                             │
               ┌────────┴─────────┐         ┌─────────┴────────┐
               │                  │         │                  │<span class="hljs-built_in">
User </span>Request──►│  <span class="hljs-built_in"> Proxy Server </span>  ├────────►|  Backend<span class="hljs-built_in"> Server </span> │
               │                  │         │                  │
               └──────────────────┘         └──────────────────┘
</code></pre>
<p>First of all we should add following dependencies to our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Versions</span> </span>{
  <span class="hljs-keyword">val</span> http4s         = <span class="hljs-string">"0.21.24"</span>
  <span class="hljs-keyword">val</span> jaeger         = <span class="hljs-string">"1.6.0"</span>
  <span class="hljs-keyword">val</span> sttp           = <span class="hljs-string">"2.2.9"</span>
  <span class="hljs-keyword">val</span> opentracing    = <span class="hljs-string">"0.33.0"</span>
  <span class="hljs-keyword">val</span> opentelemetry  = <span class="hljs-string">"1.4.1"</span>
  <span class="hljs-keyword">val</span> opencensus     = <span class="hljs-string">"0.28.3"</span>
  <span class="hljs-keyword">val</span> zipkin         = <span class="hljs-string">"2.16.3"</span>
  <span class="hljs-keyword">val</span> zio            = <span class="hljs-string">"1.0.9"</span>
  <span class="hljs-keyword">val</span> zioInteropCats = <span class="hljs-string">"2.5.1.0"</span>
}

<span class="hljs-keyword">lazy</span> <span class="hljs-keyword">val</span> openTracingExample = <span class="hljs-type">Seq</span>(
  <span class="hljs-string">"org.typelevel"</span>                %% <span class="hljs-string">"cats-core"</span>                     % <span class="hljs-string">"2.6.1"</span>,
  <span class="hljs-string">"io.circe"</span>                     %% <span class="hljs-string">"circe-generic"</span>                 % <span class="hljs-string">"0.14.1"</span>,
  <span class="hljs-string">"org.http4s"</span>                   %% <span class="hljs-string">"http4s-core"</span>                   % <span class="hljs-type">Versions</span>.http4s,
  <span class="hljs-string">"org.http4s"</span>                   %% <span class="hljs-string">"http4s-blaze-server"</span>           % <span class="hljs-type">Versions</span>.http4s,
  <span class="hljs-string">"org.http4s"</span>                   %% <span class="hljs-string">"http4s-dsl"</span>                    % <span class="hljs-type">Versions</span>.http4s,
  <span class="hljs-string">"org.http4s"</span>                   %% <span class="hljs-string">"http4s-circe"</span>                  % <span class="hljs-type">Versions</span>.http4s,
  <span class="hljs-string">"io.jaegertracing"</span>              % <span class="hljs-string">"jaeger-core"</span>                   % <span class="hljs-type">Versions</span>.jaeger,
  <span class="hljs-string">"io.jaegertracing"</span>              % <span class="hljs-string">"jaeger-client"</span>                 % <span class="hljs-type">Versions</span>.jaeger,
  <span class="hljs-string">"io.jaegertracing"</span>              % <span class="hljs-string">"jaeger-zipkin"</span>                 % <span class="hljs-type">Versions</span>.jaeger,
  <span class="hljs-string">"com.github.pureconfig"</span>        %% <span class="hljs-string">"pureconfig"</span>                    % <span class="hljs-string">"0.16.0"</span>,
  <span class="hljs-string">"com.softwaremill.sttp.client"</span> %% <span class="hljs-string">"async-http-client-backend-zio"</span> % <span class="hljs-type">Versions</span>.sttp,
  <span class="hljs-string">"com.softwaremill.sttp.client"</span> %% <span class="hljs-string">"circe"</span>                         % <span class="hljs-type">Versions</span>.sttp,
  <span class="hljs-string">"dev.zio"</span>                      %% <span class="hljs-string">"zio-interop-cats"</span>              % <span class="hljs-type">Versions</span>.zioInteropCats,
  <span class="hljs-string">"io.zipkin.reporter2"</span>           % <span class="hljs-string">"zipkin-reporter"</span>               % <span class="hljs-type">Versions</span>.zipkin,
  <span class="hljs-string">"io.zipkin.reporter2"</span>           % <span class="hljs-string">"zipkin-sender-okhttp3"</span>         % <span class="hljs-type">Versions</span>.zipkin
)
</code></pre>
<p>Let's create a <code>ZLayer</code> for <code>OpenTracing</code> which provides us Jaeger tracer. Each microservice uses this layer to send its tracing data to the <em>Jaeger Backend</em>:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.jaegertracing.<span class="hljs-type">Configuration</span>
<span class="hljs-keyword">import</span> io.jaegertracing.internal.samplers.<span class="hljs-type">ConstSampler</span>
<span class="hljs-keyword">import</span> io.jaegertracing.zipkin.<span class="hljs-type">ZipkinV2Reporter</span>
<span class="hljs-keyword">import</span> org.apache.http.client.utils.<span class="hljs-type">URIBuilder</span>
<span class="hljs-keyword">import</span> zio.<span class="hljs-type">ZLayer</span>
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.telemetry.opentracing.<span class="hljs-type">OpenTracing</span>
<span class="hljs-keyword">import</span> zipkin2.reporter.<span class="hljs-type">AsyncReporter</span>
<span class="hljs-keyword">import</span> zipkin2.reporter.okhttp3.<span class="hljs-type">OkHttpSender</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">JaegerTracer</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">makeJaegerTracer</span></span>(host: <span class="hljs-type">String</span>, serviceName: <span class="hljs-type">String</span>): <span class="hljs-type">ZLayer</span>[<span class="hljs-type">Clock</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">Clock</span> <span class="hljs-keyword">with</span> <span class="hljs-type">OpenTracing</span>] =
    <span class="hljs-type">OpenTracing</span>.live(<span class="hljs-keyword">new</span> <span class="hljs-type">Configuration</span>(serviceName)
      .getTracerBuilder
      .withSampler(<span class="hljs-keyword">new</span> <span class="hljs-type">ConstSampler</span>(<span class="hljs-literal">true</span>))
      .withReporter(
        <span class="hljs-keyword">new</span> <span class="hljs-type">ZipkinV2Reporter</span>(
          <span class="hljs-type">AsyncReporter</span>.create(
            <span class="hljs-type">OkHttpSender</span>.newBuilder
              .compressionEnabled(<span class="hljs-literal">true</span>)
              .endpoint(
                <span class="hljs-keyword">new</span> <span class="hljs-type">URIBuilder</span>()
                  .setScheme(<span class="hljs-string">"http"</span>)
                  .setHost(host)
                  .setPath(<span class="hljs-string">"/api/v2/spans"</span>)
                  .build.toString
              )
              .build
          )
        )
      )
      .build
    ) ++ <span class="hljs-type">Clock</span>.live
}
</code></pre>
<p>The <em>BackendServer</em>:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.opentracing.propagation.<span class="hljs-type">Format</span>.<span class="hljs-type">Builtin</span>.{<span class="hljs-type">HTTP_HEADERS</span> =&gt; <span class="hljs-type">HttpHeadersFormat</span>}
<span class="hljs-keyword">import</span> io.opentracing.propagation.<span class="hljs-type">TextMapAdapter</span>
<span class="hljs-keyword">import</span> org.http4s._
<span class="hljs-keyword">import</span> org.http4s.dsl.<span class="hljs-type">Http4sDsl</span>
<span class="hljs-keyword">import</span> org.http4s.server.<span class="hljs-type">Router</span>
<span class="hljs-keyword">import</span> org.http4s.server.blaze.<span class="hljs-type">BlazeServerBuilder</span>
<span class="hljs-keyword">import</span> org.http4s.syntax.kleisli._
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.interop.catz._
<span class="hljs-keyword">import</span> zio.telemetry.opentracing._
<span class="hljs-keyword">import</span> <span class="hljs-type">JaegerTracer</span>.makeJaegerTracer
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">ZEnv</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-keyword">import</span> scala.jdk.<span class="hljs-type">CollectionConverters</span>._

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">BackendServer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatsApp</span> </span>{
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">AppTask</span>[<span class="hljs-type">A</span>] </span>= <span class="hljs-type">ZIO</span>[<span class="hljs-type">Clock</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">A</span>]

  <span class="hljs-keyword">val</span> dsl: <span class="hljs-type">Http4sDsl</span>[<span class="hljs-type">AppTask</span>] = <span class="hljs-type">Http4sDsl</span>[<span class="hljs-type">AppTask</span>]
  <span class="hljs-keyword">import</span> dsl._

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">ZIO</span>[<span class="hljs-type">ZEnv</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">ExitCode</span>] =
    <span class="hljs-type">ZIO</span>.runtime[<span class="hljs-type">Clock</span>].flatMap { <span class="hljs-keyword">implicit</span> runtime =&gt;
      <span class="hljs-type">BlazeServerBuilder</span>[<span class="hljs-type">AppTask</span>](runtime.platform.executor.asEC)
        .bindHttp(port = <span class="hljs-number">9000</span>, host = <span class="hljs-string">"0.0.0.0"</span>)
        .withHttpApp(
          <span class="hljs-type">Router</span>[<span class="hljs-type">AppTask</span>](mappings = <span class="hljs-string">"/"</span> -&gt;
            <span class="hljs-type">HttpRoutes</span>.of[<span class="hljs-type">AppTask</span>] { <span class="hljs-keyword">case</span> request<span class="hljs-meta">@GET</span> -&gt; <span class="hljs-type">Root</span> =&gt;
              <span class="hljs-type">ZIO</span>.unit
                .spanFrom(
                  format = <span class="hljs-type">HttpHeadersFormat</span>,
                  carrier = <span class="hljs-keyword">new</span> <span class="hljs-type">TextMapAdapter</span>(request.headers.toList.map(h =&gt; h.name.value -&gt; h.value).toMap.asJava),
                  operation = <span class="hljs-string">"GET /"</span>
                )
                .provideLayer(makeJaegerTracer(host = <span class="hljs-string">"0.0.0.0:9411"</span>, serviceName = <span class="hljs-string">"backend-service"</span>)) *&gt; <span class="hljs-type">Ok</span>(<span class="hljs-string">"Ok!"</span>)
            }
          ).orNotFound
        )
        .serve
        .compile
        .drain
    }.exitCode
}
</code></pre>
<p>And the <em>ProxyServer</em> which calls the <em>BackendServer</em>:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> cats.effect.{<span class="hljs-type">ExitCode</span> =&gt; catsExitCode}
<span class="hljs-keyword">import</span> io.opentracing.propagation.<span class="hljs-type">Format</span>.<span class="hljs-type">Builtin</span>.{<span class="hljs-type">HTTP_HEADERS</span> =&gt; <span class="hljs-type">HttpHeadersFormat</span>}
<span class="hljs-keyword">import</span> io.opentracing.propagation.<span class="hljs-type">TextMapAdapter</span>
<span class="hljs-keyword">import</span> io.opentracing.tag.<span class="hljs-type">Tags</span>
<span class="hljs-keyword">import</span> org.http4s.<span class="hljs-type">HttpRoutes</span>
<span class="hljs-keyword">import</span> org.http4s.dsl.<span class="hljs-type">Http4sDsl</span>
<span class="hljs-keyword">import</span> org.http4s.server.<span class="hljs-type">Router</span>
<span class="hljs-keyword">import</span> org.http4s.server.blaze.<span class="hljs-type">BlazeServerBuilder</span>
<span class="hljs-keyword">import</span> org.http4s.syntax.kleisli._
<span class="hljs-keyword">import</span> sttp.client.asynchttpclient.zio.<span class="hljs-type">AsyncHttpClientZioBackend</span>
<span class="hljs-keyword">import</span> sttp.client.basicRequest
<span class="hljs-keyword">import</span> sttp.model.<span class="hljs-type">Uri</span>
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.interop.catz._
<span class="hljs-keyword">import</span> zio.telemetry.opentracing.<span class="hljs-type">OpenTracing</span>
<span class="hljs-keyword">import</span> <span class="hljs-type">JaegerTracer</span>.makeJaegerTracer
<span class="hljs-keyword">import</span> zio.{<span class="hljs-type">ExitCode</span>, <span class="hljs-type">UIO</span>, <span class="hljs-type">ZEnv</span>, <span class="hljs-type">ZIO</span>}

<span class="hljs-keyword">import</span> scala.collection.mutable
<span class="hljs-keyword">import</span> scala.jdk.<span class="hljs-type">CollectionConverters</span>._

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ProxyServer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatsApp</span> </span>{

  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">AppTask</span>[<span class="hljs-type">A</span>] </span>= <span class="hljs-type">ZIO</span>[<span class="hljs-type">Clock</span>, <span class="hljs-type">Throwable</span>, <span class="hljs-type">A</span>]

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> backend = <span class="hljs-type">AsyncHttpClientZioBackend</span>()

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">ZIO</span>[<span class="hljs-type">ZEnv</span>, <span class="hljs-type">Nothing</span>, <span class="hljs-type">ExitCode</span>] =
    <span class="hljs-type">ZIO</span>.runtime[<span class="hljs-type">Clock</span>].flatMap { <span class="hljs-keyword">implicit</span> runtime =&gt;
      <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">val</span> ec = runtime.platform.executor.asEC
      <span class="hljs-type">BlazeServerBuilder</span>[<span class="hljs-type">AppTask</span>](ec)
        .bindHttp(port = <span class="hljs-number">8080</span>, host = <span class="hljs-string">"0.0.0.0"</span>)
        .withHttpApp(
          <span class="hljs-type">Router</span>[<span class="hljs-type">AppTask</span>](mappings = <span class="hljs-string">"/"</span> -&gt; {
            <span class="hljs-keyword">val</span> dsl: <span class="hljs-type">Http4sDsl</span>[<span class="hljs-type">AppTask</span>] = <span class="hljs-type">Http4sDsl</span>[<span class="hljs-type">AppTask</span>]
            <span class="hljs-keyword">import</span> dsl._

            <span class="hljs-type">HttpRoutes</span>.of[<span class="hljs-type">AppTask</span>] { <span class="hljs-keyword">case</span> <span class="hljs-type">GET</span> -&gt; <span class="hljs-type">Root</span> =&gt;
              (<span class="hljs-keyword">for</span> {
                _ &lt;- <span class="hljs-type">OpenTracing</span>.tag(<span class="hljs-type">Tags</span>.<span class="hljs-type">SPAN_KIND</span>.getKey, <span class="hljs-type">Tags</span>.<span class="hljs-type">SPAN_KIND_CLIENT</span>)
                _ &lt;- <span class="hljs-type">OpenTracing</span>.tag(<span class="hljs-type">Tags</span>.<span class="hljs-type">HTTP_METHOD</span>.getKey, <span class="hljs-type">GET</span>.name)
                _ &lt;- <span class="hljs-type">OpenTracing</span>.setBaggageItem(<span class="hljs-string">"proxy-baggage-item-key"</span>, <span class="hljs-string">"proxy-baggage-item-value"</span>)
                buffer = <span class="hljs-keyword">new</span> <span class="hljs-type">TextMapAdapter</span>(mutable.<span class="hljs-type">Map</span>.empty[<span class="hljs-type">String</span>, <span class="hljs-type">String</span>].asJava)
                _ &lt;- <span class="hljs-type">OpenTracing</span>.inject(<span class="hljs-type">HttpHeadersFormat</span>, buffer)
                headers &lt;- extractHeaders(buffer)
                res &lt;-
                  backend.flatMap { <span class="hljs-keyword">implicit</span> backend =&gt;
                    basicRequest.get(<span class="hljs-type">Uri</span>(<span class="hljs-string">"0.0.0.0"</span>, <span class="hljs-number">9000</span>).path(<span class="hljs-string">"/"</span>)).headers(headers).send()
                  }.map(_.body)
                    .flatMap {
                      <span class="hljs-keyword">case</span> <span class="hljs-type">Right</span>(_) =&gt; <span class="hljs-type">Ok</span>(<span class="hljs-string">"Ok!"</span>)
                      <span class="hljs-keyword">case</span> <span class="hljs-type">Left</span>(_) =&gt; <span class="hljs-type">Ok</span>(<span class="hljs-string">"Oops!"</span>)
                    }
              } <span class="hljs-keyword">yield</span> res)
                .root(operation = <span class="hljs-string">"GET /"</span>)
                .provideLayer(
                  makeJaegerTracer(host = <span class="hljs-string">"0.0.0.0:9411"</span>, serviceName = <span class="hljs-string">"proxy-server"</span>)
                )
            }
          }).orNotFound
        )
        .serve
        .compile[<span class="hljs-type">AppTask</span>, <span class="hljs-type">AppTask</span>, catsExitCode]
        .drain
        .as(<span class="hljs-type">ExitCode</span>.success)
    }.exitCode

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extractHeaders</span></span>(adapter: <span class="hljs-type">TextMapAdapter</span>): <span class="hljs-type">UIO</span>[<span class="hljs-type">Map</span>[<span class="hljs-type">String</span>, <span class="hljs-type">String</span>]] = {
    <span class="hljs-keyword">val</span> m = mutable.<span class="hljs-type">Map</span>.empty[<span class="hljs-type">String</span>, <span class="hljs-type">String</span>]
    <span class="hljs-type">UIO</span>(adapter.forEach { entry =&gt;
      m.put(entry.getKey, entry.getValue)
      ()
    }).as(m.toMap)
  }

}
</code></pre>
<p>First, we run the following command to start Jaeger backend:</p>
<pre><code class="hljs css language-bash">docker run -d --name jaeger \
  -e COLLECTOR_ZIPKIN_HTTP_PORT=9411 \
  -p 5775:5775/udp \
  -p 6831:6831/udp \
  -p 6832:6832/udp \
  -p 5778:5778 \
  -p 16686:16686 \
  -p 14268:14268 \
  -p 9411:9411 \
  jaegertracing/all-in-one:1.6
</code></pre>
<p>It's time to run Backend and Proxy servers. After starting these two, we can start calling <code>ProxyServer</code>:</p>
<pre><code class="hljs css language-scala">curl -<span class="hljs-type">X</span> <span class="hljs-type">GET</span> http:<span class="hljs-comment">//0.0.0.0:8080/</span>
</code></pre>
<p>Now we can check the Jaeger service (<a href="http://localhost:16686/">http://localhost:16686/</a>) to see the result.</p>
<h2><a class="anchor" aria-hidden="true" id="zio-zmx"></a><a href="#zio-zmx" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZIO ZMX</h2>
<p><a href="https://github.com/zio/zio-zmx">ZIO ZMX</a> is a monitoring, metrics, and diagnostics toolkit for ZIO applications.</p>
<h3><a class="anchor" aria-hidden="true" id="introduction-17"></a><a href="#introduction-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<p>So ZIO ZMX is giving us a straightforward way to understand exactly what is going on in our ZIO application when we deploy that in production.</p>
<p>ZIO ZMX key features:</p>
<ul>
<li><strong>Easy Setup</strong> — It seamlessly integrates with an existing application. We don't need to change any line of the existing ZIO application, except a few lines of code at the top level.</li>
<li><strong>Diagnostics</strong> —  To track the activity of fibers in a ZIP application including fiber lifetimes and reason for termination.</li>
<li><strong>Metrics</strong> — Tracking of user-defined metrics (Counter, Gauge, Histogram, etc.)</li>
<li><strong>Integrations</strong> — Support for major metrics collection services including <em><a href="https://github.com/prometheus/prometheus">Prometheus</a></em> and <em><a href="https://github.com/statsd/statsd">StatsD</a></em>.</li>
<li><strong>Zero Dependencies</strong> - No dependencies other than ZIO itself.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="installation-20"></a><a href="#installation-20" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h3>
<p>In order to use this library, we need to add the following line in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"dev.zio"</span> %% <span class="hljs-string">"zio-zmx"</span> % <span class="hljs-string">"0.0.6"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-20"></a><a href="#example-20" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<p>To run this example, we also should add the following dependency in our <code>build.sbt</code> file:</p>
<pre><code class="hljs css language-scala">libraryDependencies += <span class="hljs-string">"org.polynote"</span> %% <span class="hljs-string">"uzhttp"</span> % <span class="hljs-string">"0.2.7"</span>
</code></pre>
<p>In this example, we expose metric information using <em>Prometheus</em> protocol:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> uzhttp._
<span class="hljs-keyword">import</span> uzhttp.server.<span class="hljs-type">Server</span>
<span class="hljs-keyword">import</span> zio._
<span class="hljs-keyword">import</span> zio.blocking.<span class="hljs-type">Blocking</span>
<span class="hljs-keyword">import</span> zio.clock.<span class="hljs-type">Clock</span>
<span class="hljs-keyword">import</span> zio.console._
<span class="hljs-keyword">import</span> zio.duration.durationInt
<span class="hljs-keyword">import</span> zio.zmx.metrics._
<span class="hljs-keyword">import</span> zio.zmx.prometheus.<span class="hljs-type">PrometheusClient</span>

<span class="hljs-keyword">import</span> java.io.<span class="hljs-type">IOException</span>
<span class="hljs-keyword">import</span> java.lang
<span class="hljs-keyword">import</span> java.net.<span class="hljs-type">InetSocketAddress</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">ZmxSampleApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">zio</span>.<span class="hljs-title">App</span> </span>{

  <span class="hljs-keyword">val</span> myApp: <span class="hljs-type">ZIO</span>[<span class="hljs-type">Console</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Clock</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Has</span>[<span class="hljs-type">PrometheusClient</span>] <span class="hljs-keyword">with</span> <span class="hljs-type">Blocking</span>, <span class="hljs-type">IOException</span>, <span class="hljs-type">Unit</span>] =
    <span class="hljs-keyword">for</span> {
      server &lt;-
        <span class="hljs-type">Server</span>
          .builder(<span class="hljs-keyword">new</span> <span class="hljs-type">InetSocketAddress</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">8080</span>))
          .handleSome { <span class="hljs-keyword">case</span> request <span class="hljs-keyword">if</span> request.uri.getPath == <span class="hljs-string">"/"</span> =&gt;
            <span class="hljs-type">PrometheusClient</span>.snapshot.map(p =&gt; <span class="hljs-type">Response</span>.plain(p.value))
          }
          .serve
          .use(_.awaitShutdown).fork
      program &lt;-
        (<span class="hljs-keyword">for</span> {
          _ &lt;- (<span class="hljs-type">ZIO</span>.sleep(<span class="hljs-number">1.</span>seconds) *&gt; request @@ <span class="hljs-type">MetricAspect</span>.count(<span class="hljs-string">"request_counts"</span>)).forever.forkDaemon
          _ &lt;- (<span class="hljs-type">ZIO</span>.sleep(<span class="hljs-number">3.</span>seconds) *&gt;
            <span class="hljs-type">ZIO</span>.succeed(
              lang.<span class="hljs-type">Runtime</span>.getRuntime.totalMemory() - lang.<span class="hljs-type">Runtime</span>.getRuntime.freeMemory()
            ).map(_ / (<span class="hljs-number">1024.0</span> * <span class="hljs-number">1024.0</span>)) @@ <span class="hljs-type">MetricAspect</span>.setGauge(<span class="hljs-string">"memory_usage"</span>)).forever.forkDaemon
        } <span class="hljs-keyword">yield</span> ()).fork
      _ &lt;- putStrLn(<span class="hljs-string">"Press Any Key"</span>) *&gt; getStrLn.catchAll(_ =&gt; <span class="hljs-type">ZIO</span>.none) *&gt; server.interrupt *&gt; program.interrupt
    } <span class="hljs-keyword">yield</span> ()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(args: <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">URIO</span>[<span class="hljs-type">ZEnv</span>, <span class="hljs-type">ExitCode</span>] =
    myApp.provideCustomLayer(<span class="hljs-type">PrometheusClient</span>.live).exitCode

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">request</span></span>: <span class="hljs-type">UIO</span>[<span class="hljs-type">Unit</span>] = <span class="hljs-type">ZIO</span>.unit
}
</code></pre>
<p>By calling the following API we can access metric information:</p>
<pre><code class="hljs css language-bash">curl -X GET localhost:8080
</code></pre>
<p>Now we can config the Prometheus server to scrape metric information periodically.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/resources/learning/poweredbyzio"><span class="arrow-prev">← </span><span>Projects using ZIO</span></a><a class="docs-next button" href="/docs/resources/ecosystem/community"><span>Community ZIO Libraries</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#zio-actors">ZIO Actors</a><ul class="toc-headings"><li><a href="#introduction">Introduction</a></li><li><a href="#installation">Installation</a></li><li><a href="#example">Example</a></li></ul></li><li><a href="#zio-akka-cluster">ZIO Akka Cluster</a><ul class="toc-headings"><li><a href="#introduction-1">Introduction</a></li><li><a href="#installation-1">Installation</a></li><li><a href="#example-1">Example</a></li></ul></li><li><a href="#zio-cache">ZIO Cache</a><ul class="toc-headings"><li><a href="#introduction-2">Introduction</a></li><li><a href="#installation-2">Installation</a></li><li><a href="#example-2">Example</a></li></ul></li><li><a href="#zio-config">ZIO Config</a><ul class="toc-headings"><li><a href="#introduction-3">Introduction</a></li><li><a href="#installation-3">Installation</a></li><li><a href="#example-3">Example</a></li></ul></li><li><a href="#zio-ftp">ZIO FTP</a><ul class="toc-headings"><li><a href="#installation-4">Installation</a></li><li><a href="#example-4">Example</a></li></ul></li><li><a href="#zio-json">ZIO JSON</a><ul class="toc-headings"><li><a href="#introduction-4">Introduction</a></li><li><a href="#installation-5">Installation</a></li><li><a href="#example-5">Example</a></li></ul></li><li><a href="#zio-kafka">ZIO Kafka</a><ul class="toc-headings"><li><a href="#introduction-5">Introduction</a></li><li><a href="#installation-6">Installation</a></li><li><a href="#example-6">Example</a></li></ul></li><li><a href="#zio-logging">ZIO Logging</a><ul class="toc-headings"><li><a href="#introduction-6">Introduction</a></li><li><a href="#installation-7">Installation</a></li><li><a href="#example-7">Example</a></li><li><a href="#introduction-7">Introduction</a></li><li><a href="#installation-8">Installation</a></li><li><a href="#example-8">Example</a></li></ul></li><li><a href="#zio-nio">ZIO NIO</a><ul class="toc-headings"><li><a href="#introduction-8">Introduction</a></li><li><a href="#installation-9">Installation</a></li><li><a href="#example-9">Example</a></li></ul></li><li><a href="#zio-optics">ZIO Optics</a><ul class="toc-headings"><li><a href="#introduction-9">Introduction</a></li><li><a href="#installation-10">Installation</a></li><li><a href="#example-10">Example</a></li></ul></li><li><a href="#zio-prelude">ZIO Prelude</a><ul class="toc-headings"><li><a href="#introduction-10">Introduction</a></li><li><a href="#installation-11">Installation</a></li><li><a href="#example-11">Example</a></li></ul></li><li><a href="#zio-process">ZIO Process</a><ul class="toc-headings"><li><a href="#introduction-11">Introduction</a></li><li><a href="#installation-12">Installation</a></li><li><a href="#example-12">Example</a></li></ul></li><li><a href="#zio-query">ZIO Query</a><ul class="toc-headings"><li><a href="#introduction-12">Introduction</a></li><li><a href="#installation-13">Installation</a></li><li><a href="#example-13">Example</a></li></ul></li><li><a href="#zio-redis">ZIO Redis</a><ul class="toc-headings"><li><a href="#introduction-13">Introduction</a></li><li><a href="#installation-14">Installation</a></li><li><a href="#example-14">Example</a></li></ul></li><li><a href="#zio-rocksdb">ZIO RocksDB</a><ul class="toc-headings"><li><a href="#installation-15">Installation</a></li><li><a href="#example-15">Example</a></li></ul></li><li><a href="#zio-s3">ZIO S3</a><ul class="toc-headings"><li><a href="#installation-16">Installation</a></li><li><a href="#example-16">Example</a></li></ul></li><li><a href="#zio-schema">ZIO Schema</a><ul class="toc-headings"><li><a href="#introduction-14">Introduction</a></li><li><a href="#installation-17">Installation</a></li><li><a href="#example-17">Example</a></li></ul></li><li><a href="#zio-sqs">ZIO SQS</a><ul class="toc-headings"><li><a href="#introduction-15">Introduction</a></li><li><a href="#installation-18">Installation</a></li><li><a href="#example-18">Example</a></li></ul></li><li><a href="#zio-telemetry">ZIO Telemetry</a><ul class="toc-headings"><li><a href="#introduction-16">Introduction</a></li><li><a href="#installation-19">Installation</a></li><li><a href="#example-19">Example</a></li></ul></li><li><a href="#zio-zmx">ZIO ZMX</a><ul class="toc-headings"><li><a href="#introduction-17">Introduction</a></li><li><a href="#installation-20">Installation</a></li><li><a href="#example-20">Example</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/navbar_brand.png" alt="ZIO"/></a><div><h5>GitHub</h5><a href="https://github.com/zio/zio"><img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github"/></a></div><div><h5>Chat with us on Discord</h5><a href="https://discord.gg/2ccFBr4"><img src="https://img.shields.io/discord/629491597070827530?logo=discord&amp;style=social" alt="discord"/></a></div><div><h5>Follow us on Twitter</h5><a href="https://twitter.com/zioscala"><img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&amp;style=social" alt="twitter"/></a></div><div><h5>Additional resources</h5><a href="https://javadoc.io/doc/dev.zio/zio_2.12/">Scaladoc of zio</a></div><div><a href="https://www.netlify.com"><img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify"/></a></div></section><section class="copyright">Copyright © 2021 ZIO Maintainers</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '0c94b59071da7001757d08ab43d9e033',
                indexName: 'zio',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>