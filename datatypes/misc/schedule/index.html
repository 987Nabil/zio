<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="ZIO" href="/opensearch.xml">
<link rel="stylesheet" href="/css/prism/prism-material-dark.css"><title data-react-helmet="true">Schedule | ZIO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://zio.dev/datatypes/misc/schedule"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Schedule | ZIO"><meta data-react-helmet="true" name="description" content="A Schedule[Env, In, Out] is an immutable value that describes a recurring effectful schedule, which runs in some environment Env, after consuming values of type In (errors in the case of retry, or values in the case of repeat) produces values of type Out, and in every step based on input values and the internal state decides to halt or continue after some delay d."><meta data-react-helmet="true" property="og:description" content="A Schedule[Env, In, Out] is an immutable value that describes a recurring effectful schedule, which runs in some environment Env, after consuming values of type In (errors in the case of retry, or values in the case of repeat) produces values of type Out, and in every step based on input values and the internal state decides to halt or continue after some delay d."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://zio.dev/datatypes/misc/schedule"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/datatypes/misc/schedule" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/datatypes/misc/schedule" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.015efd66.css">
<link rel="preload" href="/assets/js/runtime~main.ad03e6a0.js" as="script">
<link rel="preload" href="/assets/js/main.b903b205.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/overview/overview_index">Overview</a><a class="navbar__item navbar__link" href="/datatypes/index">Data Types</a><a class="navbar__item navbar__link" href="/usecases/usecases_index">Use Cases</a><a class="navbar__item navbar__link" href="/howto/index">How to</a><a class="navbar__item navbar__link" href="/resources/index">Resources</a><a class="navbar__item navbar__link" href="/about/about_index">About</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/overview/overview_index">ZIO 2.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/datatypes/misc/schedule">ZIO 2.x</a></li><li><a class="dropdown__link" href="/1.x/datatypes/misc/schedule">ZIO 1.x</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Core Data Types</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contextual Types</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concurrency</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Resource Safety</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Streaming</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metrics</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Miscellaneous</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/datatypes/misc/chunk">Chunk</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/datatypes/misc/schedule">Schedule</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/datatypes/misc/supervisor">Supervisor</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: ZIO 2.x</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Schedule</h1></header><p>A <code>Schedule[Env, In, Out]</code> is an <strong>immutable value</strong> that <strong>describes</strong> a recurring effectful schedule, which runs in some environment <code>Env</code>, after consuming values of type <code>In</code> (errors in the case of <code>retry</code>, or values in the case of <code>repeat</code>) produces values of type <code>Out</code>, and in every step based on input values and the internal state decides to halt or continue after some delay <strong>d</strong>.</p><p>Schedules are defined as a possibly infinite set of intervals spread out over time. Each interval defines a window in which recurrence is possible.</p><p>When schedules are used to repeat or retry effects, the starting boundary of each interval produced by a schedule is used as the moment when the effect will be executed again.</p><p>A variety of other operators exist for transforming and combining schedules, and the companion object for <code>Schedule</code> contains all common types of schedules, both for performing retrying, as well as performing repetition.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="repeat-and-retry"></a>Repeat and Retry<a class="hash-link" href="#repeat-and-retry" title="Direct link to heading">#</a></h2><p>Schedules allow us to define and compose flexible recurrence schedules, which can be used to <strong>repeat</strong> actions, or <strong>retry</strong> actions in the event of errors.</p><p>Repetition and retrying are two similar concepts in the domain of scheduling. It is the same concept and idea, only one of them looks for successes and the other one looks for failures. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="repeat"></a>Repeat<a class="hash-link" href="#repeat" title="Direct link to heading">#</a></h3><p>In the case of repetition, ZIO has a <code>ZIO#repeat</code> function, which takes a schedule as a repetition policy and returns another effect that describes an effect with repetition strategy according to that policy.</p><p>Repeat policies are used in the following functions:</p><ul><li><code>ZIO#repeat</code> â€” Repeats an effect until the schedule is done.</li><li><code>ZIO#repeatOrElse</code> â€” Repeats an effect until the schedule is done, with a fallback for errors.</li></ul><blockquote><p><em><strong>Note:</strong></em></p><p>Scheduled recurrences are in addition to the first execution, so that <code>io.repeat(Schedule.once)</code> yields an effect that executes <code>io</code>, and then if that succeeds, executes <code>io</code> an additional time.</p></blockquote><p>Let&#x27;s see how we can create a repeated effect by using <code>ZIO#repeat</code> function:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val action:      ZIO[R, E, A] = ???</span></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, A, B] = ???</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val repeated = action repeat policy</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>There is another version of <code>repeat</code> that helps us to have a fallback strategy in case of erros, if something goes wrong we can handle that by using the <code>ZIO#repeatOrElse</code> function, which helps up to add an <code>orElse</code> callback that will run in case of repetition failure:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val action:       ZIO[R, E, A] = ???</span></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, A, B] = ???</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val orElse: (E, Option[B]) =&gt; ZIO[R1, E2, B] = ???</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val repeated = action repeatOrElse (policy, orElse)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="retry"></a>Retry<a class="hash-link" href="#retry" title="Direct link to heading">#</a></h3><p>In the case of retrying, ZIO has a <code>ZIO#retry</code> function, which takes a schedule as a repetition policy and returns another effect that describes an effect with repetition strategy which will retry following the failure of the original effect.</p><p>Repeat policies are used in the following functions:</p><ul><li><code>ZIO#retry</code> â€“ Retries an effect until it succeeds.</li><li><code>ZIO#retryOrElse</code> â€” Retries an effect until it succeeds, with a fallback for errors.</li></ul><p>Let&#x27;s see how we can create a repeated effect by using <code>ZIO#retry</code> function:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val action:       ZIO[R, E, A] = ???</span></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, E, S] = ???</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val repeated = action retry policy</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>There is another version of <code>retry</code> that helps us to have a fallback strategy in case of erros, if something goes wrong we can handle that by using the <code>ZIO#retryOrElse</code> function, which helps up to add an <code>orElse</code> callback that will run in case of failure of repetition failure:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val action:       ZIO[R, E, A] = ???</span></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, A, B] = ???</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val orElse: (E, S) =&gt; ZIO[R1, E1, A1] = ???</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val repeated = action retryOrElse (policy, orElse)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="base-schedules"></a>Base Schedules<a class="hash-link" href="#base-schedules" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="stop"></a>stop<a class="hash-link" href="#stop" title="Direct link to heading">#</a></h3><p>A schedule that does not recur, just stops and returns one <code>Unit</code> element:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val stop = Schedule.stop</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="once"></a>once<a class="hash-link" href="#once" title="Direct link to heading">#</a></h3><p>A schedule that recurs one time an returns one <code>Unit</code> element:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val once = Schedule.once</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="forever"></a>forever<a class="hash-link" href="#forever" title="Direct link to heading">#</a></h3><p>A schedule that always recurs and produces number of recurrence at each run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val forever = Schedule.forever</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="recurs"></a>recurs<a class="hash-link" href="#recurs" title="Direct link to heading">#</a></h3><p>A schedule that only recurs the specified number of times:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val recurs = Schedule.recurs(5)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="spaced"></a>spaced<a class="hash-link" href="#spaced" title="Direct link to heading">#</a></h3><p>A schedule that recurs continuously, each repetition spaced the specified duration from the last run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val spaced = Schedule.spaced(10.milliseconds)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="fixed"></a>fixed<a class="hash-link" href="#fixed" title="Direct link to heading">#</a></h3><p>A schedule that recurs on a fixed interval. Returns the number of repetitions of the schedule so far:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val fixed = Schedule.fixed(10.seconds)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="exponential"></a>exponential<a class="hash-link" href="#exponential" title="Direct link to heading">#</a></h3><p>A schedule that recurs using exponential backoff:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val exponential = Schedule.exponential(10.milliseconds)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="fibonacci"></a>fibonacci<a class="hash-link" href="#fibonacci" title="Direct link to heading">#</a></h3><p>A schedule that always recurs, increasing delays by summing the preceding two delays (similar to the fibonacci sequence). Returns the current duration between recurrences:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val fibonacci = Schedule.fibonacci(10.milliseconds)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="identity"></a>identity<a class="hash-link" href="#identity" title="Direct link to heading">#</a></h3><p>A schedule that always decides to continue. It recurs forever, without any delay. <code>identity</code> schedule consumes input, and emit the same as output (<code>Schedule[Any, A, A]</code>):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val identity = Schedule.identity[Int]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="unfold"></a>unfold<a class="hash-link" href="#unfold" title="Direct link to heading">#</a></h3><p>A schedule that repeats one time from the specified state and iterator:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val unfold = Schedule.unfold(0)(_ + 1)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="succeed"></a>succeed<a class="hash-link" href="#succeed" title="Direct link to heading">#</a></h3><p>Returns a schedule that repeats one time, producing the specified constant value:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val constant = Schedule.succeed(5)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="fromfunction"></a>fromFunction<a class="hash-link" href="#fromfunction" title="Direct link to heading">#</a></h3><p>A schedule that always recurs, mapping input values through the specified function:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val inc = Schedule.fromFunction[Int, Int](_ + 1)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="schedule-combinators"></a>Schedule Combinators<a class="hash-link" href="#schedule-combinators" title="Direct link to heading">#</a></h2><p>Schedules define stateful, possibly effectful, recurring schedules of events, and compose in a variety of ways. Combinators allow us to take schedules and combine them together to get other schedules and if we have combinators with just the right properties. Then in theory we should be able to solve an infinite number of problems, with only a few combinators and few base schedules.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="composition"></a>Composition<a class="hash-link" href="#composition" title="Direct link to heading">#</a></h3><p>Schedules compose in the following primary ways:</p><ul><li><strong>Union</strong>. This performs the union of the intervals of two schedules.</li><li><strong>Intersection</strong>. This performs the intersection of the intervals of two schedules.</li><li><strong>Sequence</strong>. This concatenates the intervals of one schedule onto another.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="union"></a>Union<a class="hash-link" href="#union" title="Direct link to heading">#</a></h4><p>Combines two schedules through union, by recurring if either schedule wants to
recur, using the minimum of the two delays between recurrences.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1</code> | | <code>s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, A, C]</code></td><td><code>Schedule[R, A, (B, C)]</code></td></tr><tr><td>Continute: <code>Boolean</code></td><td><code>b1</code></td><td><code>b2</code></td><td><code>b1</code> | | <code>b2</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1.min(d2)</code></td></tr><tr><td>Emit: <code>(A, B)</code></td><td><code>a</code></td><td><code>b</code></td><td><code>(a, b)</code></td></tr></tbody></table><p>We can combine two schedule through union with <code>||</code> operator:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val expCapped = Schedule.exponential(100.milliseconds) || Schedule.spaced(1.second)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="intersection"></a>Intersection<a class="hash-link" href="#intersection" title="Direct link to heading">#</a></h4><p>Combines two schedules through the intersection, by recurring only if both schedules want to recur, using the maximum of the two delays between recurrences.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1 &amp;&amp; s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, A, C]</code></td><td><code>Schedule[R, A, (B, C)]</code></td></tr><tr><td>Continute: <code>Boolean</code></td><td><code>b1</code></td><td><code>b2</code></td><td><code>b1 &amp;&amp; b2</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1.max(d2)</code></td></tr><tr><td>Emit: <code>(A, B)</code></td><td><code>a</code></td><td><code>b</code></td><td><code>(a, b)</code></td></tr></tbody></table><p>We can intersect two schedule with <code>&amp;&amp;</code> operator:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val expUpTo10 = Schedule.exponential(1.second) &amp;&amp; Schedule.recurs(10)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="sequence"></a>Sequence<a class="hash-link" href="#sequence" title="Direct link to heading">#</a></h4><p>Combines two schedules sequentially, by following the first policy until it ends, and then following the second policy.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1 andThen s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, A, C]</code></td><td><code>Schedule[R, A, C]</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1 + d2</code></td></tr><tr><td>Emit: <code>B</code></td><td><code>a</code></td><td><code>b</code></td><td><code>b</code></td></tr></tbody></table><p>We can sequence two schedule by using <code>andThen</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val sequential = Schedule.recurs(10) andThen Schedule.spaced(1.second)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="piping"></a>Piping<a class="hash-link" href="#piping" title="Direct link to heading">#</a></h3><p>Combine two schedules by piping the output of the first schedule to the input of the other. Effects described by the first schedule will always be executed before the effects described by the second schedule.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1 &gt;&gt;&gt; s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, B, C]</code></td><td><code>Schedule[R, A, C]</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1 + d2</code></td></tr><tr><td>Emit: <code>B</code></td><td><code>a</code></td><td><code>b</code></td><td><code>b</code></td></tr></tbody></table><p>We can pipe two schedule by using <code>&gt;&gt;&gt;</code> operator:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val totalElapsed = Schedule.spaced(1.second) &lt;* Schedule.recurs(5) &gt;&gt;&gt; Schedule.elapsed</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="jittering"></a>Jittering<a class="hash-link" href="#jittering" title="Direct link to heading">#</a></h3><p>A <code>jittered</code> is a combinator that takes one schedule and returns another schedule of the same type except for the delay which is applied randomly:</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>jittered</code></td><td></td><td><code>Schedule[Env with Random, In, Out]</code></td></tr><tr><td><code>jittered</code></td><td><code>min: Double, max: Double</code></td><td><code>Schedule[Env with Random, In, Out]</code></td></tr></tbody></table><p>We can jitter any schedule by calling <code>jittered</code> on it:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val jitteredExp = Schedule.exponential(10.milliseconds).jittered</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>When a resource is out of service due to overload or contention, retrying and backing off doesn&#x27;t help us. If all failed API calls are backed off to the same point of time, they cause another overload or contention. Jitter adds some amount of randomness to the delay of the schedule. This helps us to avoid ending up accidentally synchronizing and taking the service down by accident.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="collecting"></a>Collecting<a class="hash-link" href="#collecting" title="Direct link to heading">#</a></h3><p>A <code>collectAll</code> is a combinator that when we call it on a schedule, produces a new schedule that collects the outputs of the first schedule into a chunk.</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>collectAll</code></td><td><code>Schedule[Env, In, Out]</code></td><td><code>Schedule[Env, In, Chunk[Out]]</code></td></tr></tbody></table><p>In the following example, we are catching all recurrence of schedule into <code>Chunk</code>, so at the end, it would contain <code>Chunk(0, 1, 2, 3, 4)</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val collect = Schedule.recurs(5).collectAll</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="filtering"></a>Filtering<a class="hash-link" href="#filtering" title="Direct link to heading">#</a></h3><p>We can filter inputs or outputs of a schedule with <code>whileInput</code> and <code>whileOutput</code>. Alse ZIO schedule has an effectful version of these two functions, <code>whileInputZIO</code> and <code>whileOutputZIO</code>.</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>whileInput</code></td><td><code>In1 =&gt; Boolean</code></td><td><code>Schedule[Env, In1, Out]</code></td></tr><tr><td><code>whileOutput</code></td><td><code>Out =&gt; Boolean</code></td><td><code>Schedule[Env, In, Out]</code></td></tr><tr><td><code>whileInputZIO</code></td><td><code>In1 =&gt; URIO[Env1, Boolean]</code></td><td><code>Schedule[Env1, In1, Out]</code></td></tr><tr><td><code>whileOutputZIO</code></td><td><code>Out =&gt; URIO[Env1, Boolean]</code></td><td><code>Schedule[Env1, In, Out]</code></td></tr></tbody></table><p>In following example we collect all emiting outputs before reaching the 5 output, so it would return <code>Chunk(0, 1, 2, 3, 4)</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val res = Schedule.unfold(0)(_ + 1).whileOutput(_ &lt; 5).collectAll</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="mapping"></a>Mapping<a class="hash-link" href="#mapping" title="Direct link to heading">#</a></h3><p>There are two versions for mapping schedules, <code>map</code> and its effectful version <code>mapZIO</code>.</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>map</code></td><td><code>f: Out =&gt; Out2</code></td><td><code>Schedule[Env, In, Out2]</code></td></tr><tr><td><code>mapZIO</code></td><td><code>f: Out =&gt; URIO[Env1, Out2]</code></td><td><code>Schedule[Env1, In, Out2]</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="leftright-ap"></a>Left/Right Ap<a class="hash-link" href="#leftright-ap" title="Direct link to heading">#</a></h3><p>Sometimes when we intersect two schedules with the <code>&amp;&amp;</code> operator, we just need to ignore the left or the right output. </p><ul><li><ul><li><code>*&gt;</code> ignore the left output </li></ul></li><li><ul><li><code>&lt;*</code> ignore the right output</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="modifying"></a>Modifying<a class="hash-link" href="#modifying" title="Direct link to heading">#</a></h3><p>Modifies the delay of a schedule:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val boosted = Schedule.spaced(1.second).delayed(_ =&gt; 100.milliseconds)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="tapping"></a>Tapping<a class="hash-link" href="#tapping" title="Direct link to heading">#</a></h3><p>Whenever we need to effectfully process each schedule input/output, we can use <code>tapInput</code> and <code>tapOutput</code>.</p><p>We can use these two functions for logging purposes:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val tappedSchedule = Schedule.count.whileOutput(_ &lt; 5).tapOutput(o =&gt; Console.printLine(s&quot;retrying $o&quot;).orDie)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="examples"></a>Examples<a class="hash-link" href="#examples" title="Direct link to heading">#</a></h2><p>Stops retrying after a specified amount of time has elapsed:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">val expMaxElapsed = (Schedule.exponential(10.milliseconds) &gt;&gt;&gt; Schedule.elapsed).whileOutput(_ &lt; 30.seconds)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Retry only when a specific exception occurs:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly scala"><pre tabindex="0" class="prism-code language-scala codeBlock_23N8 thin-scrollbar"><code class="codeBlockLines_39YC"><span class="token-line"><span class="token plain">import scala.concurrent.TimeoutException</span></span><span class="token-line"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line"><span class="token plain">val whileTimeout = Schedule.exponential(10.milliseconds) &amp;&amp; Schedule.recurWhile[Throwable] {</span></span><span class="token-line"><span class="token plain">  case _: TimeoutException =&gt; true</span></span><span class="token-line"><span class="token plain">  case _ =&gt; false</span></span><span class="token-line"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/datatypes/misc/chunk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Chunk</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/datatypes/misc/supervisor"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Supervisor Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#repeat-and-retry" class="table-of-contents__link">Repeat and Retry</a><ul><li><a href="#repeat" class="table-of-contents__link">Repeat</a></li><li><a href="#retry" class="table-of-contents__link">Retry</a></li></ul></li><li><a href="#base-schedules" class="table-of-contents__link">Base Schedules</a><ul><li><a href="#stop" class="table-of-contents__link">stop</a></li><li><a href="#once" class="table-of-contents__link">once</a></li><li><a href="#forever" class="table-of-contents__link">forever</a></li><li><a href="#recurs" class="table-of-contents__link">recurs</a></li><li><a href="#spaced" class="table-of-contents__link">spaced</a></li><li><a href="#fixed" class="table-of-contents__link">fixed</a></li><li><a href="#exponential" class="table-of-contents__link">exponential</a></li><li><a href="#fibonacci" class="table-of-contents__link">fibonacci</a></li><li><a href="#identity" class="table-of-contents__link">identity</a></li><li><a href="#unfold" class="table-of-contents__link">unfold</a></li><li><a href="#succeed" class="table-of-contents__link">succeed</a></li><li><a href="#fromfunction" class="table-of-contents__link">fromFunction</a></li></ul></li><li><a href="#schedule-combinators" class="table-of-contents__link">Schedule Combinators</a><ul><li><a href="#composition" class="table-of-contents__link">Composition</a></li><li><a href="#piping" class="table-of-contents__link">Piping</a></li><li><a href="#jittering" class="table-of-contents__link">Jittering</a></li><li><a href="#collecting" class="table-of-contents__link">Collecting</a></li><li><a href="#filtering" class="table-of-contents__link">Filtering</a></li><li><a href="#mapping" class="table-of-contents__link">Mapping</a></li><li><a href="#leftright-ap" class="table-of-contents__link">Left/Right Ap</a></li><li><a href="#modifying" class="table-of-contents__link">Modifying</a></li><li><a href="#tapping" class="table-of-contents__link">Tapping</a></li></ul></li><li><a href="#examples" class="table-of-contents__link">Examples</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item">
                <img src="/img/navbar_brand.png" alt="zio">
            </li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items"><li class="footer__item">
              <a href="https://github.com/zio/zio">
                <img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github">
              </a>
            </li></ul></div><div class="col footer__col"><div class="footer__title">Chat with us on Discord</div><ul class="footer__items"><li class="footer__item">
                <a href="https://discord.gg/2ccFBr4">
                  <img src="https://img.shields.io/discord/629491597070827530?logo=discord&style=social" alt="discord">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Follow us on Twitter</div><ul class="footer__items"><li class="footer__item">
                <a href="https://twitter.com/zioscala">
                  <img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&style=social" alt="twitter">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Additional resources</div><ul class="footer__items"><li class="footer__item"><a href="/api/zio/" target="_blank">Latest Scaladoc of ZIO</a></li><li class="footer__item"><a href="/api-1.x/zio/" target="_blank">Scaladoc of ZIO-1.x</a></li><li class="footer__item"><a href="https://javadoc.io/doc/dev.zio/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Scaladoc on javadoc.io<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 ZIO Maintainers - Built with <a href="https://v2.docusaurus.io/">Docusaurus v2</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.ad03e6a0.js"></script>
<script src="/assets/js/main.b903b205.js"></script>
</body>
</html>